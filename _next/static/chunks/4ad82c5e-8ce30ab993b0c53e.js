"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[762],{7421:function(a,b,c){c.d(b,{kH:function(){return Zc},p:function(){return $c},Nm:function(){return Zg},tk:function(){return Ss},BF:function(){return Lf},lg:function(){return Pf},l9:function(){return Sc},Uw:function(){return Ow},qr:function(){return Fx},ZO:function(){return Dy},AE:function(){return my},"$f":function(){return Fw},OO:function(){return Gf},"W$":function(){return Qy},"$1":function(){return Iw}});var d=c(8120),e=c(172),f=c(8699),g=c(382),h=c(3952);function i(a){return(11==a.nodeType?a.getSelection?a:a.ownerDocument:a).getSelection()}function j(a,b){return!!b&&a.contains(1!=b.nodeType?b.parentNode:b)}function k(a,b){if(!b.anchorNode)return!1;try{return j(a,b.anchorNode)}catch(c){return!1}}function l(a){return 3==a.nodeType?w(a,0,a.nodeValue.length).getClientRects():1==a.nodeType?a.getClientRects():[]}function m(a,b,c,d){return!!c&&(o(a,b,c,d,-1)||o(a,b,c,d,1))}function n(a){for(var b=0;;b++)if(!(a=a.previousSibling))return b}function o(a,b,c,d,e){for(;;){if(a==c&&b==d)return!0;if(b==(e<0?0:p(a))){if("DIV"==a.nodeName)return!1;let f=a.parentNode;if(!f||1!=f.nodeType)return!1;b=n(a)+(e<0?0:1),a=f}else{if(1!=a.nodeType)return!1;if(1==(a=a.childNodes[b+(e<0?-1:0)]).nodeType&&"false"==a.contentEditable)return!1;b=e<0?p(a):0}}}function p(a){return 3==a.nodeType?a.nodeValue.length:a.childNodes.length}const q={left:0,right:0,top:0,bottom:0};function r(a,b){let c=b?a.left:a.right;return{left:c,right:c,top:a.top,bottom:a.bottom}}function s(a){return{left:0,right:a.innerWidth,top:0,bottom:a.innerHeight}}let t=null;function u(a){if(a.setActive)return a.setActive();if(t)return a.focus(t);let b=[];for(let c=a;c&&(b.push(c,c.scrollTop,c.scrollLeft),c!=c.ownerDocument);c=c.parentNode);if(a.focus(null==t?{get preventScroll(){return t={preventScroll:!0},!0}}:void 0),!t){t=!1;for(let d=0;d<b.length;){let e=b[d++],f=b[d++],g=b[d++];e.scrollTop!=f&&(e.scrollTop=f),e.scrollLeft!=g&&(e.scrollLeft=g)}}}let v;function w(a,b,c=b){let d=v||(v=document.createRange());return d.setEnd(a,c),d.setStart(a,b),d}function x(a,b,c){let d={key:b,code:b,keyCode:c,which:c,cancelable:!0},e=new KeyboardEvent("keydown",d);e.synthetic=!0,a.dispatchEvent(e);let f=new KeyboardEvent("keyup",d);return f.synthetic=!0,a.dispatchEvent(f),e.defaultPrevented||f.defaultPrevented}class y{constructor(z,A,B=!0){this.node=z,this.offset=A,this.precise=B}static before(C,D){return new y(C.parentNode,n(C),D)}static after(E,F){return new y(E.parentNode,n(E)+1,F)}}const G=[];class H{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(I){let J=this.posAtStart;for(let K of this.children){if(K==I)return J;J+=K.length+K.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(L){return this.posBefore(L)+L.length}coordsAt(M,N){return null}sync(O){var P;if(2&this.dirty){let Q=this.dom,R=Q.firstChild;for(let S of this.children)if(S.dirty&&(S.dom||!R||(null===(P=H.get(R))|| void 0===P?void 0:P.parent)||S.reuseDOM(R),S.sync(O),S.dirty=0),O&&!O.written&&O.node==Q&&R!=S.dom&&(O.written=!0),S.dom.parentNode==Q){for(;R&&R!=S.dom;)R=Oa(R);R=S.dom.nextSibling}else Q.insertBefore(S.dom,R);for(R&&O&&O.node==Q&&(O.written=!0);R;)R=Oa(R)}else if(1&this.dirty)for(let T of this.children)T.dirty&&(T.sync(O),T.dirty=0)}reuseDOM(U){return!1}localPosFromDOM(V,W){let X;if(V==this.dom)X=this.dom.childNodes[W];else{let Y=0==p(V)?0:0==W?-1:1;for(;;){let Z=V.parentNode;if(Z==this.dom)break;0==Y&&Z.firstChild!=Z.lastChild&&(Y=V==Z.firstChild?-1:1),V=Z}X=Y<0?V:V.nextSibling}if(X==this.dom.firstChild)return 0;for(;X&&!H.get(X);)X=X.nextSibling;if(!X)return this.length;for(let $=0,_=0;;$++){let aa=this.children[$];if(aa.dom==X)return _;_+=aa.length+aa.breakAfter}}domBoundsAround(ba,ca,da=0){let ea=-1,fa=-1,ga=-1,ha=-1;for(let ia=0,ja=da,ka=da;ia<this.children.length;ia++){let la=this.children[ia],ma=ja+la.length;if(ja<ba&&ma>ca)return la.domBoundsAround(ba,ca,ja);if(ma>=ba&& -1==ea&&(ea=ia,fa=ja),ja>ca&&la.dom.parentNode==this.dom){ga=ia,ha=ka;break}ka=ma,ja=ma+la.breakAfter}return{from:fa,to:ha<0?da+this.length:ha,startDOM:(ea?this.children[ea-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:ga<this.children.length&&ga>=0?this.children[ga].dom:null}}markDirty(na=!1){this.dirty|=2,this.markParentsDirty(na)}markParentsDirty(oa){for(let pa=this.parent;pa;pa=pa.parent){if(oa&&(pa.dirty|=2),1&pa.dirty)return;pa.dirty|=1,oa=!1}}setParent(qa){this.parent!=qa&&(this.parent=qa,this.dirty&&this.markParentsDirty(!0))}setDOM(ra){this.dom&&(this.dom.cmView=null),this.dom=ra,ra.cmView=this}get rootView(){for(let sa=this;;){let ta=sa.parent;if(!ta)return sa;sa=ta}}replaceChildren(ua,va,wa=G){this.markDirty();for(let xa=ua;xa<va;xa++){let ya=this.children[xa];ya.parent==this&&ya.destroy()}this.children.splice(ua,va-ua,...wa);for(let za=0;za<wa.length;za++)wa[za].setParent(this)}ignoreMutation(Aa){return!1}ignoreEvent(Ba){return!1}childCursor(Ca=this.length){return new Pa(this.children,Ca,this.children.length)}childPos(Da,Ea=1){return this.childCursor().findPos(Da,Ea)}toString(){let Fa=this.constructor.name.replace("View","");return Fa+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==Fa?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(Ga){return Ga.cmView}get isEditable(){return!0}merge(Ha,Ia,Ja,Ka,La,Ma){return!1}become(Na){return!1}getSide(){return 0}destroy(){this.parent=null}}function Oa(a){let b=a.nextSibling;return a.parentNode.removeChild(a),b}H.prototype.breakAfter=0;class Pa{constructor(Qa,Ra,Sa){this.children=Qa,this.pos=Ra,this.i=Sa,this.off=0}findPos(Ta,Ua=1){for(;;){if(Ta>this.pos||Ta==this.pos&&(Ua>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=Ta-this.pos,this;let Va=this.children[--this.i];this.pos-=Va.length+Va.breakAfter}}}function Wa(a,b,c,d,e,f,g,h,i){let{children:j}=a,k=j.length?j[b]:null,l=f.length?f[f.length-1]:null,m=l?l.breakAfter:g;if(!(b==d&&k&&!g&&!m&&f.length<2&&k.merge(c,e,f.length?l:null,0==c,h,i))){if(d<j.length){let n=j[d];n&&e<n.length?(b==d&&(n=n.split(e),e=0),!m&&l&&n.merge(0,e,l,!0,0,i)?f[f.length-1]=n:(e&&n.merge(0,e,null,!1,0,i),f.push(n))):(null==n?void 0:n.breakAfter)&&(l?l.breakAfter=1:g=1),d++}for(k&&(k.breakAfter=g,c>0&&(!g&&f.length&&k.merge(c,k.length,f[0],!1,h,0)?k.breakAfter=f.shift().breakAfter:(c<k.length||k.children.length&&0==k.children[k.children.length-1].length)&&k.merge(c,k.length,null,!1,h,0),b++));b<d&&f.length;)if(j[d-1].become(f[f.length-1]))d--,f.pop(),i=f.length?0:h;else if(j[b].become(f[0]))b++,f.shift(),h=f.length?0:i;else break;!f.length&&b&&d<j.length&&!j[b-1].breakAfter&&j[d].merge(0,0,j[b-1],!1,h,i)&&b--,(b<d||f.length)&&a.replaceChildren(b,d,f)}}function Xa(a,b,c,d,e,f){let g=a.childCursor(),{i:h,off:i}=g.findPos(c,1),{i:j,off:k}=g.findPos(b,-1),l=b-c;for(let m of d)l+=m.length;a.length+=l,Wa(a,j,k,h,i,d,0,e,f)}let[Ya,Za]="undefined"!=typeof navigator?[navigator,document]:[{userAgent:"",vendor:"",platform:""},{documentElement:{style:{}}}];const $a=/Edge\/(\d+)/.exec(Ya.userAgent),_a=/MSIE \d/.test(Ya.userAgent),ab=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ya.userAgent),bb=!!(_a||ab||$a),cb=!bb&&/gecko\/(\d+)/i.test(Ya.userAgent),db=!bb&&/Chrome\/(\d+)/.exec(Ya.userAgent),eb="webkitFontSmoothing"in Za.documentElement.style,fb=!bb&&/Apple Computer/.test(Ya.vendor),gb=fb&&(/Mobile\/\w+/.test(Ya.userAgent)||Ya.maxTouchPoints>2);var hb={mac:gb||/Mac/.test(Ya.platform),windows:/Win/.test(Ya.platform),linux:/Linux|X11/.test(Ya.platform),ie:bb,ie_version:_a?Za.documentMode||6:ab?+ab[1]:$a?+$a[1]:0,gecko:cb,gecko_version:cb?+(/Firefox\/(\d+)/.exec(Ya.userAgent)||[0,0])[1]:0,chrome:!!db,chrome_version:db?+db[1]:0,ios:gb,android:/Android\b/.test(Ya.userAgent),webkit:eb,safari:fb,webkit_version:eb?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Za.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class ib extends H{constructor(jb){super(),this.text=jb}get length(){return this.text.length}createDOM(kb){this.setDOM(kb||document.createTextNode(this.text))}sync(lb){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(lb&&lb.node==this.dom&&(lb.written=!0),this.dom.nodeValue=this.text)}reuseDOM(mb){return 3==mb.nodeType&&(this.createDOM(mb),!0)}merge(nb,ob,pb){return(!pb||pb instanceof ib&&!(this.length-(ob-nb)+pb.length>256))&&(this.text=this.text.slice(0,nb)+(pb?pb.text:"")+this.text.slice(ob),this.markDirty(),!0)}split(qb){let rb=new ib(this.text.slice(qb));return this.text=this.text.slice(0,qb),this.markDirty(),rb}localPosFromDOM(sb,tb){return sb==this.dom?tb:tb?this.text.length:0}domAtPos(ub){return new y(this.dom,ub)}domBoundsAround(vb,wb,xb){return{from:xb,to:xb+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(yb,zb){return Zb(this.dom,yb,zb)}}class Ab extends H{constructor(Bb,Cb=[],Db=0){for(let Eb of(super(),this.mark=Bb,this.children=Cb,this.length=Db,Cb))Eb.setParent(this)}createDOM(){let Fb=document.createElement(this.mark.tagName);if(this.mark.class&&(Fb.className=this.mark.class),this.mark.attrs)for(let Gb in this.mark.attrs)Fb.setAttribute(Gb,this.mark.attrs[Gb]);this.setDOM(Fb)}sync(Hb){(!this.dom||4&this.dirty)&&this.createDOM(),super.sync(Hb)}merge(Ib,Jb,Kb,Lb,Mb,Nb){return(!Kb|| !!(Kb instanceof Ab&&Kb.mark.eq(this.mark))&&(!Ib||!(Mb<=0))&&(!(Jb<this.length)||!(Nb<=0)))&&(Xa(this,Ib,Jb,Kb?Kb.children:[],Mb-1,Nb-1),this.markDirty(),!0)}split(Ob){let Pb=[],Qb=0,Rb=-1,Sb=0;for(let Tb of this.children){let Ub=Qb+Tb.length;Ub>Ob&&Pb.push(Qb<Ob?Tb.split(Ob-Qb):Tb),Rb<0&&Qb>=Ob&&(Rb=Sb),Qb=Ub,Sb++}let Vb=this.length-Ob;return this.length=Ob,Rb> -1&&(this.children.length=Rb,this.markDirty()),new Ab(this.mark,Pb,Vb)}domAtPos(Wb){return Mc(this.dom,this.children,Wb)}coordsAt(Xb,Yb){return Oc(this,Xb,Yb)}}function Zb(a,b,c){let d=a.nodeValue.length;b>d&&(b=d);let e=b,f=b,g=0;0==b&&c<0||b==d&&c>=0?hb.chrome||hb.gecko||(b?(e--,g=1):(f++,g=-1)):c<0?e--:f++;let h=w(a,e,f).getClientRects();if(!h.length)return q;let i=h[(g?g<0:c>=0)?0:h.length-1];return hb.safari&&!g&&0==i.width&&(i=Array.prototype.find.call(h,a=>a.width)||i),g?r(i,g<0):i||null}class $b extends H{constructor(_b,ac,bc){super(),this.widget=_b,this.length=ac,this.side=bc}static create(cc,dc,ec){return new(cc.customView||$b)(cc,dc,ec)}split(fc){let gc=$b.create(this.widget,this.length-fc,this.side);return this.length-=fc,gc}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(hc,ic,jc,kc,lc,mc){return(!jc||jc instanceof $b&&!!this.widget.compare(jc.widget)&&(!(hc>0)||!(lc<=0))&&(!(ic<this.length)||!(mc<=0)))&&(this.length=hc+(jc?jc.length:0)+(this.length-ic),!0)}become(nc){return nc.length==this.length&&nc instanceof $b&&nc.side==this.side&&this.widget.constructor==nc.widget.constructor&&(this.widget.eq(nc.widget)||this.markDirty(!0),this.widget=nc.widget,!0)}ignoreMutation(){return!0}ignoreEvent(oc){return this.widget.ignoreEvent(oc)}get overrideDOMText(){if(0==this.length)return e.xv.empty;let pc=this;for(;pc.parent;)pc=pc.parent;let qc=pc.editorView,rc=qc&&qc.state.doc,sc=this.posAtStart;return rc?rc.slice(sc,sc+this.length):e.xv.empty}domAtPos(tc){return 0==tc?y.before(this.dom):y.after(this.dom,tc==this.length)}domBoundsAround(){return null}coordsAt(uc,vc){let wc=this.dom.getClientRects(),xc=null;if(!wc.length)return q;for(let yc=uc>0?wc.length-1:0;xc=wc[yc],uc>0?0!=yc:yc!=wc.length-1&&!(xc.top<xc.bottom);yc+=uc>0?-1:1);return 0==uc&&vc>0||uc==this.length&&vc<=0?xc:r(xc,0==uc)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class zc extends $b{domAtPos(Ac){return new y(this.widget.text,Ac)}sync(){this.dom||this.setDOM(this.widget.toDOM())}localPosFromDOM(Bc,Cc){return Cc?3==Bc.nodeType?Math.min(Cc,this.length):this.length:0}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(Dc,Ec){return Zb(this.widget.text,Dc,Ec)}get isEditable(){return!0}}const Fc=hb.android?"​​":"​";class Gc extends H{constructor(Hc){super(),this.side=Hc}get length(){return 0}merge(){return!1}become(Ic){return Ic instanceof Gc&&Ic.side==this.side}split(){return new Gc(this.side)}sync(){this.dom?this.dirty&&this.dom.nodeValue!=Fc&&(this.dom.nodeValue=Fc):this.setDOM(document.createTextNode(Fc))}getSide(){return this.side}domAtPos(Jc){return y.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(Kc){let Lc=l(this.dom);return Lc[Lc.length-1]||null}get overrideDOMText(){return e.xv.of([this.dom.nodeValue.replace(/\u200b/g,"")])}}function Mc(a,b,c){let d=0;for(let e=0;d<b.length;d++){let f=b[d],g=e+f.length;if(!(g==e&&0>=f.getSide())){if(c>e&&c<g&&f.dom.parentNode==a)return f.domAtPos(c-e);if(c<=e)break;e=g}}for(;d>0;d--){let h=b[d-1].dom;if(h.parentNode==a)return y.after(h)}return new y(a,0)}function Nc(a,b,c){let d,{children:e}=a;c>0&&b instanceof Ab&&e.length&&(d=e[e.length-1])instanceof Ab&&d.mark.eq(b.mark)?Nc(d,b.children[0],c-1):(e.push(b),b.setParent(a)),a.length+=b.length}function Oc(a,b,c){for(let d=0,e=0;e<a.children.length;e++){let f=a.children[e],g=d+f.length,h;if((c<=0||g==a.length||f.getSide()>0?g>=b:g>b)&&(b<g||e+1==a.children.length||(h=a.children[e+1]).length||h.getSide()>0)){let i=0;if(g==d){if(0>=f.getSide())continue;i=c=-f.getSide()}let j=f.coordsAt(b-d,c);return i&&j?r(j,c<0):j}d=g}let k=a.dom.lastChild;if(!k)return a.dom.getBoundingClientRect();let m=l(k);return m[m.length-1]||null}function Pc(a,b){for(let c in a)"class"==c&&b.class?b.class+=" "+a.class:"style"==c&&b.style?b.style+=";"+a.style:b[c]=a[c];return b}function Qc(a,b){if(a==b)return!0;if(!a||!b)return!1;let c=Object.keys(a),d=Object.keys(b);if(c.length!=d.length)return!1;for(let e of c)if(-1==d.indexOf(e)||a[e]!==b[e])return!1;return!0}function Rc(a,b,c){if(b)for(let d in b)c&&d in c||a.removeAttribute(d);if(c)for(let e in c)b&&b[e]==c[e]||a.setAttribute(e,c[e])}ib.prototype.children=$b.prototype.children=Gc.prototype.children=G;class Sc{eq(Tc){return!1}updateDOM(Uc){return!1}compare(Vc){return this==Vc||this.constructor==Vc.constructor&&this.eq(Vc)}get estimatedHeight(){return -1}ignoreEvent(Wc){return!0}get customView(){return null}destroy(Xc){}}var Yc,Zc=((Yc=Zc||(Zc={}))[Yc.Text=0]="Text",Yc[Yc.WidgetBefore=1]="WidgetBefore",Yc[Yc.WidgetAfter=2]="WidgetAfter",Yc[Yc.WidgetRange=3]="WidgetRange",Yc);class $c extends g.uU{constructor(_c,ad,bd,cd){super(),this.startSide=_c,this.endSide=ad,this.widget=bd,this.spec=cd}get heightRelevant(){return!1}static mark(dd){return new od(dd)}static widget(ed){let fd=ed.side||0,gd=!!ed.block;return fd+=gd?fd>0?30e7:-40e7:fd>0?10e7:-10e7,new Ad(ed,fd,fd,gd,ed.widget||null,!1)}static replace(hd){let id=!!hd.block,{start:jd,end:kd}=Kd(hd,id);return new Ad(hd,id?jd?-30e7:-1:40e7,id?kd?20e7:1:-50e7,id,hd.widget||null,!0)}static line(ld){return new vd(ld)}static set(md,nd=!1){return g.Xs.of(md,nd)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight> -1}}$c.none=g.Xs.empty;class od extends $c{constructor(pd){let{start:qd,end:rd}=Kd(pd);super(qd?-1:40e7,rd?1:-50e7,null,pd),this.tagName=pd.tagName||"span",this.class=pd.class||"",this.attrs=pd.attributes||null}eq(sd){return this==sd||sd instanceof od&&this.tagName==sd.tagName&&this.class==sd.class&&Qc(this.attrs,sd.attrs)}range(td,ud=td){if(td>=ud)throw new RangeError("Mark decorations may not be empty");return super.range(td,ud)}}od.prototype.point=!1;class vd extends $c{constructor(wd){super(-20e7,-20e7,null,wd)}eq(xd){return xd instanceof vd&&Qc(this.spec.attributes,xd.spec.attributes)}range(yd,zd=yd){if(zd!=yd)throw new RangeError("Line decoration ranges must be zero-length");return super.range(yd,zd)}}vd.prototype.mapMode=d.gc.TrackBefore,vd.prototype.point=!0;class Ad extends $c{constructor(Bd,Cd,Dd,Ed,Fd,Gd){super(Cd,Dd,Fd,Bd),this.block=Ed,this.isReplace=Gd,this.mapMode=Ed?Cd<=0?d.gc.TrackBefore:d.gc.TrackAfter:d.gc.TrackDel}get type(){return this.startSide<this.endSide?Zc.WidgetRange:this.startSide<=0?Zc.WidgetBefore:Zc.WidgetAfter}get heightRelevant(){return this.block|| !!this.widget&&this.widget.estimatedHeight>=5}eq(Hd){return Hd instanceof Ad&&Ld(this.widget,Hd.widget)&&this.block==Hd.block&&this.startSide==Hd.startSide&&this.endSide==Hd.endSide}range(Id,Jd=Id){if(this.isReplace&&(Id>Jd||Id==Jd&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&Jd!=Id)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(Id,Jd)}}function Kd(a,b=!1){let{inclusiveStart:c,inclusiveEnd:d}=a;return null==c&&(c=a.inclusive),null==d&&(d=a.inclusive),{start:null!=c?c:b,end:null!=d?d:b}}function Ld(a,b){return a==b||!!(a&&b&&a.compare(b))}function Md(a,b,c,d=0){let e=c.length-1;e>=0&&c[e]+d>a?c[e]=Math.max(c[e],b):c.push(a,b)}Ad.prototype.point=!0;class Nd extends H{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(Od,Pd,Qd,Rd,Sd,Td){if(Qd){if(!(Qd instanceof Nd))return!1;this.dom||Qd.transferDOM(this)}return Rd&&this.setDeco(Qd?Qd.attrs:null),Xa(this,Od,Pd,Qd?Qd.children:[],Sd,Td),!0}split(Ud){let Vd=new Nd;if(Vd.breakAfter=this.breakAfter,0==this.length)return Vd;let{i:Wd,off:Xd}=this.childPos(Ud);Xd&&(Vd.append(this.children[Wd].split(Xd),0),this.children[Wd].merge(Xd,this.children[Wd].length,null,!1,0,0),Wd++);for(let Yd=Wd;Yd<this.children.length;Yd++)Vd.append(this.children[Yd],0);for(;Wd>0&&0==this.children[Wd-1].length;)this.children[--Wd].destroy();return this.children.length=Wd,this.markDirty(),this.length=Ud,Vd}transferDOM(Zd){this.dom&&(Zd.setDOM(this.dom),Zd.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco($d){Qc(this.attrs,$d)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=$d)}append(_d,ae){Nc(this,_d,ae)}addLineDeco(be){let ce=be.spec.attributes,de=be.spec.class;ce&&(this.attrs=Pc(ce,this.attrs||{})),de&&(this.attrs=Pc(ce,{class:de}))}domAtPos(ee){return Mc(this.dom,this.children,ee)}sync(fe){var ge;(!this.dom||4&this.dirty)&&(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Rc(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(fe);let he=this.dom.lastChild;for(;he&&H.get(he) instanceof Ab;)he=he.lastChild;if(!he||"BR"!=he.nodeName&&(null===(ge=H.get(he))|| void 0===ge?void 0:ge.isEditable)== !1&&(!hb.ios||!this.children.some(a=>a instanceof ib))){let ie=document.createElement("BR");ie.cmIgnore=!0,this.dom.appendChild(ie)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let je=0;for(let ke of this.children){if(!(ke instanceof ib))return null;let le=l(ke.dom);if(1!=le.length)return null;je+=le[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:je/this.length}}coordsAt(me,ne){return Oc(this,me,ne)}become(oe){return!1}get type(){return Zc.Text}static find(pe,qe){for(let re=0,se=0;;re++){let te=pe.children[re],ue=se+te.length;if(ue>=qe){if(te instanceof Nd)return te;if(te.length)return null}se=ue+te.breakAfter}}}class ve extends H{constructor(we,xe,ye){super(),this.widget=we,this.length=xe,this.type=ye,this.breakAfter=0}merge(ze,Ae,Be,Ce,De,Ee){return(!Be||Be instanceof ve&&!!this.widget.compare(Be.widget)&&(!(ze>0)||!(De<=0))&&(!(Ae<this.length)||!(Ee<=0)))&&(this.length=ze+(Be?Be.length:0)+(this.length-Ae),!0)}domAtPos(Fe){return 0==Fe?y.before(this.dom):y.after(this.dom,Fe==this.length)}split(Ge){let He=this.length-Ge;this.length=Ge;let Ie=new ve(this.widget,He,this.type);return Ie.breakAfter=this.breakAfter,Ie}get children(){return G}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):e.xv.empty}domBoundsAround(){return null}become(Je){return Je instanceof ve&&Je.type==this.type&&Je.widget.constructor==this.widget.constructor&&(Je.widget.eq(this.widget)||this.markDirty(!0),this.widget=Je.widget,this.length=Je.length,this.breakAfter=Je.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(Ke){return this.widget.ignoreEvent(Ke)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Le{constructor(Me,Ne,Oe){this.doc=Me,this.pos=Ne,this.end=Oe,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=Me.iter(),this.skip=Ne}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let Pe=this.content[this.content.length-1];return!Pe.breakAfter&&!(Pe instanceof ve&&Pe.type==Zc.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Nd),this.atCursorPos=!0),this.curLine}flushBuffer(Qe){this.pendingBuffer&&(this.curLine.append(tf(new Gc(-1),Qe),Qe.length),this.pendingBuffer=0)}addBlockWidget(Re){this.flushBuffer([]),this.curLine=null,this.content.push(Re)}finish(Se){Se?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(Te,Ue,Ve){for(;Te>0;){if(this.textOff==this.text.length){let{value:We,lineBreak:Xe,done:Ye}=this.cursor.next(this.skip);if(this.skip=0,Ye)throw new Error("Ran out of text content when drawing inline views");if(Xe){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,Te--;continue}this.text=We,this.textOff=0}let Ze=Math.min(this.text.length-this.textOff,Te,512);this.flushBuffer(Ue),this.getLine().append(tf(new ib(this.text.slice(this.textOff,this.textOff+Ze)),Ue),Ve),this.atCursorPos=!0,this.textOff+=Ze,Te-=Ze,Ve=0}}span($e,_e,af,bf){this.buildText(_e-$e,af,bf),this.pos=_e,this.openStart<0&&(this.openStart=bf)}point(cf,df,ef,ff,gf){let hf=df-cf;if(ef instanceof Ad)if(ef.block){let{type:jf}=ef;jf!=Zc.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new ve(ef.widget||new uf("div"),hf,jf))}else{let kf=$b.create(ef.widget||new uf("span"),hf,ef.startSide),lf=this.atCursorPos&&!kf.isEditable&&gf<=ff.length&&(cf<df||ef.startSide>0),mf=!kf.isEditable&&(cf<df||ef.startSide<=0),nf=this.getLine();2!=this.pendingBuffer||lf||(this.pendingBuffer=0),this.flushBuffer(ff),lf&&(nf.append(tf(new Gc(1),ff),gf),gf=ff.length+Math.max(0,gf-ff.length)),nf.append(tf(kf,ff),gf),this.atCursorPos=mf,this.pendingBuffer=mf?cf<df?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(ef);hf&&(this.textOff+hf<=this.text.length?this.textOff+=hf:(this.skip+=hf-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=df),this.openStart<0&&(this.openStart=gf)}static build(of,pf,qf,rf){let sf=new Le(of,pf,qf);return sf.openEnd=g.Xs.spans(rf,pf,qf,sf),sf.openStart<0&&(sf.openStart=sf.openEnd),sf.finish(sf.openEnd),sf}}function tf(a,b){for(let c of b)a=new Ab(c,[a],a.length);return a}class uf extends Sc{constructor(vf){super(),this.tag=vf}eq(wf){return wf.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(xf){return xf.nodeName.toLowerCase()==this.tag}}const yf=d.r$.define(),zf=d.r$.define(),Af=d.r$.define(),Bf=d.r$.define(),Cf=d.r$.define(),Df=d.r$.define(),Ef=d.Py.define({map:(a,b)=>a.map(b)}),Ff=d.Py.define({map:(a,b)=>a.map(b)});function Gf(a,b,c){let d=a.facet(Bf);d.length?d[0](b):window.onerror?window.onerror(String(b),c,void 0,void 0,b):c?console.error(c+":",b):console.error(b)}const Hf=d.r$.define({combine:a=>!a.length||a[0]});class If{constructor(Jf,Kf){this.field=Jf,this.get=Kf}}class Lf{from(Mf){return new If(this,Mf)}static define(){return new Lf()}}Lf.decorations=Lf.define(),Lf.atomicRanges=Lf.define(),Lf.scrollMargins=Lf.define();let Nf=0;const Of=d.r$.define();class Pf{constructor(Qf,Rf,Sf){this.id=Qf,this.create=Rf,this.fields=Sf,this.extension=Of.of(this)}static define(Tf,Uf){let{eventHandlers:Vf,provide:Wf,decorations:Xf}=Uf||{},Yf=[];if(Wf)for(let Zf of Array.isArray(Wf)?Wf:[Wf])Yf.push(Zf);return Vf&&Yf.push(ag.from(a=>({plugin:a,handlers:Vf}))),Xf&&Yf.push(Lf.decorations.from(Xf)),new Pf(Nf++,Tf,Yf)}static fromClass($f,_f){return Pf.define(a=>new $f(a),_f)}}const ag=Lf.define();class bg{constructor(cg){this.spec=cg,this.mustUpdate=null,this.value=null}takeField(dg,eg){if(this.spec)for(let{field:fg,get:gg}of this.spec.fields)fg==dg&&eg.push(gg(this.value))}update(hg){if(this.value){if(this.mustUpdate){let ig=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(ig)}catch(jg){if(Gf(ig.state,jg,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(kg){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(hg)}catch(lg){Gf(hg.state,lg,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(mg){var ng;if(null===(ng=this.value)|| void 0===ng?void 0:ng.destroy)try{this.value.destroy()}catch(og){Gf(mg.state,og,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const pg=d.r$.define(),qg=d.r$.define(),rg=d.r$.define(),sg=d.r$.define();class tg{constructor(ug,vg,wg,xg){this.fromA=ug,this.toA=vg,this.fromB=wg,this.toB=xg}join(yg){return new tg(Math.min(this.fromA,yg.fromA),Math.max(this.toA,yg.toA),Math.min(this.fromB,yg.fromB),Math.max(this.toB,yg.toB))}addToSet(zg){let Ag=zg.length,Bg=this;for(;Ag>0;Ag--){let Cg=zg[Ag-1];if(!(Cg.fromA>Bg.toA)){if(Cg.toA<Bg.fromA)break;Bg=Bg.join(Cg),zg.splice(Ag-1,1)}}return zg.splice(Ag,0,Bg),zg}static extendWithRanges(Dg,Eg){if(0==Eg.length)return Dg;let Fg=[];for(let Gg=0,Hg=0,Ig=0,Jg=0;;Gg++){let Kg=Gg==Dg.length?null:Dg[Gg],Lg=Ig-Jg,Mg=Kg?Kg.fromB:10e8;for(;Hg<Eg.length&&Eg[Hg]<Mg;){let Ng=Eg[Hg],Og=Eg[Hg+1],Pg=Math.max(Jg,Ng),Qg=Math.min(Mg,Og);if(Pg<=Qg&&new tg(Pg+Lg,Qg+Lg,Pg,Qg).addToSet(Fg),Og>Mg)break;Hg+=2}if(!Kg)return Fg;new tg(Kg.fromA,Kg.toA,Kg.fromB,Kg.toB).addToSet(Fg),Ig=Kg.toA,Jg=Kg.toB}}}class Rg{constructor(Sg,Tg,Ug=[]){for(let Vg of(this.view=Sg,this.state=Tg,this.transactions=Ug,this.flags=0,this.startState=Sg.state,this.changes=d.as.empty(this.startState.doc.length),Ug))this.changes=this.changes.compose(Vg.changes);let Wg=[];this.changes.iterChangedRanges((a,b,c,d)=>Wg.push(new tg(a,b,c,d))),this.changedRanges=Wg;let Xg=Sg.hasFocus;Xg!=Sg.inputState.notifiedFocused&&(Sg.inputState.notifiedFocused=Xg,this.flags|=1),this.docChanged&&(this.flags|=2)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(a=>a.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}var Yg,Zg=((Yg=Zg||(Zg={}))[Yg.LTR=0]="LTR",Yg[Yg.RTL=1]="RTL",Yg);const $g=Zg.LTR,_g=Zg.RTL;function ah(a){let b=[];for(let c=0;c<a.length;c++)b.push(1<< +a[c]);return b}const bh=ah("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ch=ah("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),dh=Object.create(null),eh=[];for(let fh of["()","[]","{}"]){let gh=fh.charCodeAt(0),hh=fh.charCodeAt(1);dh[gh]=hh,dh[hh]=-gh}function ih(a){return a<=247?bh[a]:1424<=a&&a<=1524?2:1536<=a&&a<=1785?ch[a-1536]:1774<=a&&a<=2220?4:8192<=a&&a<=8203?256:8204==a?256:1}const jh=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class kh{constructor(lh,mh,nh){this.from=lh,this.to=mh,this.level=nh}get dir(){return this.level%2?_g:$g}side(oh,ph){return this.dir==ph==oh?this.to:this.from}static find(qh,rh,sh,th){let uh=-1;for(let vh=0;vh<qh.length;vh++){let wh=qh[vh];if(wh.from<=rh&&wh.to>=rh){if(wh.level==sh)return vh;(uh<0||(0!=th?th<0?wh.from<rh:wh.to>rh:qh[uh].level>wh.level))&&(uh=vh)}}if(uh<0)throw new RangeError("Index out of range");return uh}}const xh=[];function yh(a){return[new kh(0,a,0)]}let zh="";function Ah(a,b,c,f,g){var h;let i=f.head-a.from,j=-1;if(0==i){if(!g||!a.length)return null;b[0].level!=c&&(i=b[0].side(!1,c),j=0)}else if(i==a.length){if(g)return null;let k=b[b.length-1];k.level!=c&&(i=k.side(!0,c),j=b.length-1)}j<0&&(j=kh.find(b,i,null!==(h=f.bidiLevel)&& void 0!==h?h:-1,f.assoc));let l=b[j];i==l.side(g,c)&&(i=(l=b[j+=g?1:-1]).side(!g,c));let m=g==(l.dir==c),n=(0,e.cp)(a.text,i,m);if(zh=a.text.slice(Math.min(i,n),Math.max(i,n)),n!=l.side(g,c))return d.jT.cursor(n+a.from,m?-1:1,l.level);let o=j==(g?b.length-1:0)?null:b[j+(g?1:-1)];return o||l.level==c?o&&o.level<l.level?d.jT.cursor(o.side(!g,c)+a.from,g?1:-1,o.level):d.jT.cursor(n+a.from,g?-1:1,l.level):d.jT.cursor(g?a.to:a.from,g?-1:1,c)}class Bh{constructor(Ch,Dh){this.points=Ch,this.view=Dh,this.text="",this.lineBreak=Dh.state.lineBreak}readRange(Eh,Fh){if(!Eh)return this;let Gh=Eh.parentNode;for(let Hh=Eh;;){this.findPointBefore(Gh,Hh),this.readNode(Hh);let Ih=Hh.nextSibling;if(Ih==Fh)break;let Jh=H.get(Hh),Kh=H.get(Ih);(Jh&&Kh?Jh.breakAfter:(Jh?Jh.breakAfter:Vh(Hh))||Vh(Ih)&&("BR"!=Hh.nodeName||Hh.cmIgnore))&&(this.text+=this.lineBreak),Hh=Ih}return this.findPointBefore(Gh,Fh),this}readNode(Lh){if(!Lh.cmIgnore){let Mh=H.get(Lh),Nh=Mh&&Mh.overrideDOMText,Oh;null!=Nh?Oh=Nh.sliceString(0,void 0,this.lineBreak):3==Lh.nodeType?Oh=Lh.nodeValue:"BR"==Lh.nodeName?Oh=Lh.nextSibling?this.lineBreak:"":1==Lh.nodeType&&this.readRange(Lh.firstChild,null),null!=Oh&&(this.findPointIn(Lh,Oh.length),this.text+=Oh,hb.chrome&&13==this.view.inputState.lastKeyCode&&!Lh.nextSibling&&/\n\n$/.test(this.text)&&(this.text=this.text.slice(0,-1)))}}findPointBefore(Ph,Qh){for(let Rh of this.points)Rh.node==Ph&&Ph.childNodes[Rh.offset]==Qh&&(Rh.pos=this.text.length)}findPointIn(Sh,Th){for(let Uh of this.points)Uh.node==Sh&&(Uh.pos=this.text.length+Math.min(Uh.offset,Th))}}function Vh(a){return 1==a.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(a.nodeName)}class Wh{constructor(Xh,Yh){this.node=Xh,this.offset=Yh,this.pos=-1}}class Zh extends H{constructor($h){super(),this.view=$h,this.compositionDeco=$c.none,this.decorations=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM($h.contentDOM),this.children=[new Nd],this.children[0].setParent(this),this.updateInner([new tg(0,0,0,$h.state.doc.length)],this.updateDeco(),0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(_h){let ai=_h.changedRanges;this.minWidth>0&&ai.length&&(ai.every(({fromA:a,toA:b})=>b<this.minWidthFrom||a>this.minWidthTo)?(this.minWidthFrom=_h.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=_h.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=$c.none:(_h.transactions.length||this.dirty)&&(this.compositionDeco=_j(this.view,_h.changes)),(hb.ie||hb.chrome)&&!this.compositionDeco.size&&_h&&_h.state.doc.lines!=_h.startState.doc.lines&&(this.forceSelection=!0);let bi=this.decorations,ci=this.updateDeco(),di=lk(bi,ci,_h.changes);return ai=tg.extendWithRanges(ai,di),(0!=this.dirty||0!=ai.length)&&(this.updateInner(ai,ci,_h.startState.doc.length),_h.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(ei,fi,gi){this.view.viewState.mustMeasureContent=!0,this.updateChildren(ei,fi,gi);let{observer:hi}=this.view;hi.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.minWidth=this.minWidth?this.minWidth+"px":"";let a=hb.chrome||hb.ios?{node:hi.selectionRange.focusNode,written:!1}:void 0;this.sync(a),this.dirty=0,a&&(a.written||hi.selectionRange.focusNode!=a.node)&&(this.forceSelection=!0),this.dom.style.height=""});let ii=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let ji of this.children)ji instanceof ve&&ji.widget instanceof Wj&&ii.push(ji.dom);hi.updateGaps(ii)}updateChildren(ki,li,mi){let ni=this.childCursor(mi);for(let oi=ki.length-1;;oi--){let pi=oi>=0?ki[oi]:null;if(!pi)break;let{fromA:qi,toA:ri,fromB:si,toB:ti}=pi,{content:ui,breakAtStart:vi,openStart:wi,openEnd:xi}=Le.build(this.view.state.doc,si,ti,li),{i:yi,off:zi}=ni.findPos(ri,1),{i:Ai,off:Bi}=ni.findPos(qi,-1);Wa(this,Ai,Bi,yi,zi,ui,vi,wi,xi)}}updateSelection(Ci=!1,Di=!1){if(Ci&&this.view.observer.readSelectionRange(),(Di||this.mayControlSelection())&&(!hb.ios||!this.view.inputState.rapidCompositionStart)){let Ei=this.forceSelection;this.forceSelection=!1;let Fi=this.view.state.selection.main,Gi=this.domAtPos(Fi.anchor),Hi=Fi.empty?Gi:this.domAtPos(Fi.head);if(hb.gecko&&Fi.empty&&Vj(Gi)){let Ii=document.createTextNode("");this.view.observer.ignore(()=>Gi.node.insertBefore(Ii,Gi.node.childNodes[Gi.offset]||null)),Gi=Hi=new y(Ii,0),Ei=!0}let Ji=this.view.observer.selectionRange;!Ei&&Ji.focusNode&&m(Gi.node,Gi.offset,Ji.anchorNode,Ji.anchorOffset)&&m(Hi.node,Hi.offset,Ji.focusNode,Ji.focusOffset)||(this.view.observer.ignore(()=>{hb.android&&hb.chrome&&this.dom.contains(Ji.focusNode)&&mk(Ji.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let a=i(this.root);if(Fi.empty){if(hb.gecko){let b=fk(Gi.node,Gi.offset);if(b&&3!=b){let c=ek(Gi.node,Gi.offset,1==b?1:-1);c&&(Gi=new y(c,1==b?0:c.nodeValue.length))}}a.collapse(Gi.node,Gi.offset),null!=Fi.bidiLevel&&null!=Ji.cursorBidiLevel&&(Ji.cursorBidiLevel=Fi.bidiLevel)}else if(a.extend)a.collapse(Gi.node,Gi.offset),a.extend(Hi.node,Hi.offset);else{let d=document.createRange();Fi.anchor>Fi.head&&([Gi,Hi]=[Hi,Gi]),d.setEnd(Hi.node,Hi.offset),d.setStart(Gi.node,Gi.offset),a.removeAllRanges(),a.addRange(d)}}),this.view.observer.setSelectionRange(Gi,Hi)),this.impreciseAnchor=Gi.precise?null:new y(Ji.anchorNode,Ji.anchorOffset),this.impreciseHead=Hi.precise?null:new y(Ji.focusNode,Ji.focusOffset)}}enforceCursorAssoc(){if(!this.compositionDeco.size){let Ki=this.view.state.selection.main,Li=i(this.root);if(Ki.empty&&Ki.assoc&&Li.modify){let Mi=Nd.find(this,Ki.head);if(Mi){let Ni=Mi.posAtStart;if(Ki.head!=Ni&&Ki.head!=Ni+Mi.length){let Oi=this.coordsAt(Ki.head,-1),Pi=this.coordsAt(Ki.head,1);if(Oi&&Pi&&!(Oi.bottom>Pi.top)){let Qi=this.domAtPos(Ki.head+Ki.assoc);Li.collapse(Qi.node,Qi.offset),Li.modify("move",Ki.assoc<0?"forward":"backward","lineboundary")}}}}}}mayControlSelection(){return this.view.state.facet(Hf)?this.root.activeElement==this.dom:k(this.dom,this.view.observer.selectionRange)}nearest(Ri){for(let Si=Ri;Si;){let Ti=H.get(Si);if(Ti&&Ti.rootView==this)return Ti;Si=Si.parentNode}return null}posFromDOM(Ui,Vi){let Wi=this.nearest(Ui);if(!Wi)throw new RangeError("Trying to find position for a DOM position outside of the document");return Wi.localPosFromDOM(Ui,Vi)+Wi.posAtStart}domAtPos(Xi){let{i:Yi,off:Zi}=this.childCursor().findPos(Xi,-1);for(;Yi<this.children.length-1;){let $i=this.children[Yi];if(Zi<$i.length||$i instanceof Nd)break;Yi++,Zi=0}return this.children[Yi].domAtPos(Zi)}coordsAt(_i,aj){for(let bj=this.length,cj=this.children.length-1;;cj--){let dj=this.children[cj],ej=bj-dj.breakAfter-dj.length;if(_i>ej||_i==ej&&dj.type!=Zc.WidgetBefore&&dj.type!=Zc.WidgetAfter&&(!cj||2==aj||this.children[cj-1].breakAfter||this.children[cj-1].type==Zc.WidgetBefore&&aj> -2))return dj.coordsAt(_i-ej,aj);bj=ej}}measureVisibleLineHeights(){let fj=[],{from:gj,to:hj}=this.view.viewState.viewport,ij=this.view.contentDOM.clientWidth,jj=ij>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,kj=-1;for(let lj=0,mj=0;mj<this.children.length;mj++){let nj=this.children[mj],oj=lj+nj.length;if(oj>hj)break;if(lj>=gj){let pj=nj.dom.getBoundingClientRect();if(fj.push(pj.height),jj){let qj=nj.dom.lastChild,rj=qj?l(qj):[];if(rj.length){let sj=rj[rj.length-1],tj=this.view.textDirection==Zg.LTR?sj.right-pj.left:pj.right-sj.left;tj>kj&&(kj=tj,this.minWidth=ij,this.minWidthFrom=lj,this.minWidthTo=oj)}}}lj=oj+nj.breakAfter}return fj}measureTextSize(){for(let uj of this.children)if(uj instanceof Nd){let vj=uj.measureTextSize();if(vj)return vj}let wj=document.createElement("div"),xj,yj;return wj.className="cm-line",wj.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(wj);let a=l(wj.firstChild)[0];xj=wj.getBoundingClientRect().height,yj=a?a.width/27:7,wj.remove()}),{lineHeight:xj,charWidth:yj}}childCursor(zj=this.length){let Aj=this.children.length;return Aj&&(zj-=this.children[--Aj].length),new Pa(this.children,zj,Aj)}computeBlockGapDeco(){let Bj=[],Cj=this.view.viewState;for(let Dj=0,Ej=0;;Ej++){let Fj=Ej==Cj.viewports.length?null:Cj.viewports[Ej],Gj=Fj?Fj.from-1:this.length;if(Gj>Dj){let Hj=Cj.lineBlockAt(Gj).bottom-Cj.lineBlockAt(Dj).top;Bj.push($c.replace({widget:new Wj(Hj),block:!0,inclusive:!0}).range(Dj,Gj))}if(!Fj)break;Dj=Fj.to+1}return $c.set(Bj)}updateDeco(){return this.decorations=[...this.view.pluginField(Lf.decorations),...this.view.state.facet(rg),this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView({range:Ij,center:Jj}){let Kj=this.coordsAt(Ij.head,Ij.empty?Ij.assoc:Ij.head>Ij.anchor?-1:1),Lj;if(Kj){!Ij.empty&&(Lj=this.coordsAt(Ij.anchor,Ij.anchor>Ij.head?-1:1))&&(Kj={left:Math.min(Kj.left,Lj.left),top:Math.min(Kj.top,Lj.top),right:Math.max(Kj.right,Lj.right),bottom:Math.max(Kj.bottom,Lj.bottom)});let Mj=0,Nj=0,Oj=0,Pj=0;for(let Qj of this.view.pluginField(Lf.scrollMargins))if(Qj){let{left:Rj,right:Sj,top:Tj,bottom:Uj}=Qj;null!=Rj&&(Mj=Math.max(Mj,Rj)),null!=Sj&&(Nj=Math.max(Nj,Sj)),null!=Tj&&(Oj=Math.max(Oj,Tj)),null!=Uj&&(Pj=Math.max(Pj,Uj))}!function(a,b,c,d){let e=a.ownerDocument,f=e.defaultView;for(let g=a;g;)if(1==g.nodeType){let h,i=g==e.body;if(i)h=s(f);else{if(g.scrollHeight<=g.clientHeight&&g.scrollWidth<=g.clientWidth){g=g.parentNode;continue}let j=g.getBoundingClientRect();h={left:j.left,right:j.left+g.clientWidth,top:j.top,bottom:j.top+g.clientHeight}}let k=0,l=0;if(d){let m=b.bottom-b.top,n=h.bottom-h.top;1>=Math.abs(l=(m<=n?b.top+m/2-n/2:c<0?b.top-5:b.bottom+5-n)-h.top)&&(l=0)}else b.top<h.top?(l=-(h.top-b.top+5),c>0&&b.bottom>h.bottom+l&&(l=b.bottom-h.bottom+l+5)):b.bottom>h.bottom&&(l=b.bottom-h.bottom+5,c<0&&b.top-l<h.top&&(l=-(h.top+l-b.top+5)));if(b.left<h.left?(k=-(h.left-b.left+5),c>0&&b.right>h.right+k&&(k=b.right-h.right+k+5)):b.right>h.right&&(k=b.right-h.right+5,c<0&&b.left<h.left+k&&(k=-(h.left+k-b.left+5))),k||l)if(i)f.scrollBy(k,l);else{if(l){let o=g.scrollTop;g.scrollTop+=l,l=g.scrollTop-o}if(k){let p=g.scrollLeft;g.scrollLeft+=k,k=g.scrollLeft-p}b={left:b.left-k,top:b.top-l,right:b.right-k,bottom:b.bottom-l}}if(i)break;g=g.assignedSlot||g.parentNode,d=!1}else if(11==g.nodeType)g=g.host;else break}(this.view.scrollDOM,{left:Kj.left-Mj,top:Kj.top-Oj,right:Kj.right+Nj,bottom:Kj.bottom+Pj},Ij.head<Ij.anchor?-1:1,Jj)}}}function Vj(a){return 1==a.node.nodeType&&a.node.firstChild&&(0==a.offset||"false"==a.node.childNodes[a.offset-1].contentEditable)&&(a.offset==a.node.childNodes.length||"false"==a.node.childNodes[a.offset].contentEditable)}class Wj extends Sc{constructor(Xj){super(),this.height=Xj}toDOM(){let Yj=document.createElement("div");return this.updateDOM(Yj),Yj}eq(Zj){return Zj.height==this.height}updateDOM($j){return $j.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function _j(a,b){let c=a.observer.selectionRange,d=c.focusNode&&ek(c.focusNode,c.focusOffset,0);if(!d)return $c.none;let e=a.docView.nearest(d);if(!e)return $c.none;let f,g,h=d;if(e instanceof Nd){for(;h.parentNode!=e.dom;)h=h.parentNode;let i=h.previousSibling;for(;i&&!H.get(i);)i=i.previousSibling;f=g=i?H.get(i).posAtEnd:e.posAtStart}else{for(;;){let{parent:j}=e;if(!j)return $c.none;if(j instanceof Nd)break;e=j}g=(f=e.posAtStart)+e.length,h=e.dom}let k=b.mapPos(f,1),l=Math.max(k,b.mapPos(g,-1)),{state:m}=a,n=3==h.nodeType?h.nodeValue:new Bh([],a).readRange(h.firstChild,null).text;if(l-k<n.length)if(m.sliceDoc(k,Math.min(m.doc.length,k+n.length))==n)l=k+n.length;else{if(m.sliceDoc(Math.max(0,l-n.length),l)!=n)return $c.none;k=l-n.length}else if(m.sliceDoc(k,l)!=n)return $c.none;return $c.set($c.replace({widget:new ak(h,d)}).range(k,l))}class ak extends Sc{constructor(bk,ck){super(),this.top=bk,this.text=ck}eq(dk){return this.top==dk.top&&this.text==dk.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return zc}}function ek(a,b,c){for(;;){if(3==a.nodeType)return a;if(1==a.nodeType&&b>0&&c<=0)b=p(a=a.childNodes[b-1]);else{if(1!=a.nodeType||!(b<a.childNodes.length)||!(c>=0))return null;a=a.childNodes[b],b=0}}}function fk(a,b){return 1!=a.nodeType?0:(b&&"false"==a.childNodes[b-1].contentEditable?1:0)|(b<a.childNodes.length&&"false"==a.childNodes[b].contentEditable?2:0)}class gk{constructor(){this.changes=[]}compareRange(hk,ik){Md(hk,ik,this.changes)}comparePoint(jk,kk){Md(jk,kk,this.changes)}}function lk(a,b,c){let d=new gk;return g.Xs.compare(a,b,c,d),d.changes}function mk(a,b){for(let c=a;c&&c!=b;c=c.assignedSlot||c.parentNode)if(1==c.nodeType&&"false"==c.contentEditable)return!0;return!1}function nk(a,b){return b.left>a?b.left-a:Math.max(0,a-b.right)}function ok(a,b){return b.top>a?b.top-a:Math.max(0,a-b.bottom)}function pk(a,b){return a.top<b.bottom-1&&a.bottom>b.top+1}function qk(a,b){return b<a.top?{top:b,left:a.left,right:a.right,bottom:a.bottom}:a}function rk(a,b){return b>a.bottom?{top:a.top,left:a.left,right:a.right,bottom:b}:a}function sk(a,b,c){let d,e,f,g,h,i,j,k;for(let m=a.firstChild;m;m=m.nextSibling){let n=l(m);for(let o=0;o<n.length;o++){let p=n[o];e&&pk(e,p)&&(p=qk(rk(p,e.bottom),e.top));let q=nk(b,p),r=ok(c,p);if(0==q&&0==r)return 3==m.nodeType?tk(m,b,c):sk(m,b,c);(!d||g>r||g==r&&f>q)&&(d=m,e=p,f=q,g=r),0==q?c>p.bottom&&(!j||j.bottom<p.bottom)?(h=m,j=p):c<p.top&&(!k||k.top>p.top)&&(i=m,k=p):j&&pk(j,p)?j=rk(j,p.bottom):k&&pk(k,p)&&(k=qk(k,p.top))}}if(j&&j.bottom>=c?(d=h,e=j):k&&k.top<=c&&(d=i,e=k),!d)return{node:a,offset:0};let s=Math.max(e.left,Math.min(e.right,b));if(3==d.nodeType)return tk(d,s,c);if(!f&&"true"==d.contentEditable)return sk(d,s,c);let t=Array.prototype.indexOf.call(a.childNodes,d)+(b>=(e.left+e.right)/2?1:0);return{node:a,offset:t}}function tk(a,b,c){let d=a.nodeValue.length,e=-1,f=10e8,g=0;for(let h=0;h<d;h++){let i=w(a,h,h+1).getClientRects();for(let j=0;j<i.length;j++){let k=i[j];if(k.top!=k.bottom){g||(g=b-k.left);let l=(k.top>c?k.top-c:c-k.bottom)-1;if(k.left-1<=b&&k.right+1>=b&&l<f){let m=b>=(k.left+k.right)/2,n=m;if((hb.chrome||hb.gecko)&&w(a,h).getBoundingClientRect().left==k.right&&(n=!m),l<=0)return{node:a,offset:h+(n?1:0)};e=h+(n?1:0),f=l}}}}return{node:a,offset:e> -1?e:g>0?a.nodeValue.length:0}}function uk(a,{x:b,y:c},d,e=-1){var f;let g=a.contentDOM.getBoundingClientRect(),h=g.top+a.viewState.paddingTop,i,j=c-h,{docHeight:k}=a.viewState;if(j<0||j>k){if(d)return null;j=j<0?0:k}for(let l=a.defaultLineHeight/2,m=!1;;){if((i=a.elementAtHeight(j)).type==Zc.Text)break;for(;;){if((j=e>0?i.bottom+l:i.top-l)>=0&&j<=k)break;if(m)return d?null:0;m=!0,e=-e}}c=h+j;let n=i.from;if(b=Math.max(g.left+1,Math.min(Math.max(g.right,g.left+a.docView.minWidth)-1,b)),n<a.viewport.from)return 0==a.viewport.from?0:vk(a,g,i,b,c);if(n>a.viewport.to)return a.viewport.to==a.state.doc.length?a.state.doc.length:vk(a,g,i,b,c);let o=a.dom.ownerDocument,p=(a.root.elementFromPoint?a.root:o).elementFromPoint(b,c),q,r=-1;if(p&&a.contentDOM.contains(p)&&(null===(f=a.docView.nearest(p))|| void 0===f?void 0:f.isEditable)!= !1){if(o.caretPositionFromPoint){let s=o.caretPositionFromPoint(b,c);s&&({offsetNode:q,offset:r}=s)}else if(o.caretRangeFromPoint){let t=o.caretRangeFromPoint(b,c);t&&({startContainer:q,startOffset:r}=t,hb.safari&&wk(q,r,b)&&(q=void 0))}}if(!q||!a.docView.dom.contains(q)){let u=Nd.find(a.docView,n);({node:q,offset:r}=sk(u.dom,b,c))}return a.docView.posFromDOM(q,r)}function vk(a,b,c,d,f){let g=Math.round((d-b.left)*a.defaultCharacterWidth);a.lineWrapping&&c.height>1.5*a.defaultLineHeight&&(g+=Math.floor((f-c.top)/a.defaultLineHeight)*a.viewState.heightOracle.lineLength);let h=a.state.sliceDoc(c.from,c.to);return c.from+(0,e.Gz)(h,g,a.state.tabSize)}function wk(a,b,c){let d;if(3!=a.nodeType||b!=(d=a.nodeValue.length))return!1;for(let e=a.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return w(a,d-1,d).getBoundingClientRect().left>c}function xk(a,b,c,e){let f=a.state.doc.lineAt(b.head),g=a.bidiSpans(f);for(let h=b,i=null;;){let j=Ah(f,g,a.textDirection,h,c),k=zh;if(!j){if(f.number==(c?a.state.doc.lines:1))return h;k="\n",f=a.state.doc.line(f.number+(c?1:-1)),g=a.bidiSpans(f),j=d.jT.cursor(c?f.from:f.to)}if(i){if(!i(k))return h}else{if(!e)return j;i=e(k)}h=j}}function yk(a,b,c){let e=a.pluginField(Lf.atomicRanges);for(;;){let f=!1;for(let g of e)g.between(c.from-1,c.from+1,(a,e,g)=>{c.from>a&&c.from<e&&(c=b.from>c.from?d.jT.cursor(a,1):d.jT.cursor(e,-1),f=!0)});if(!f)return c}}const zk=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ak=[16,17,18,20,91,92,224,225];class Bk{constructor(Ck,Dk,Ek,Fk){var Gk,Hk,Ik,Jk;this.view=Ck,this.style=Ek,this.mustSelect=Fk,this.lastEvent=Dk;let Kk=Ck.contentDOM.ownerDocument,Lk,Mk;Kk.addEventListener("mousemove",this.move=this.move.bind(this)),Kk.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=Dk.shiftKey,this.multiple=Ck.state.facet(d.yy.allowMultipleSelections)&&(Gk=Ck,Hk=Dk,(Lk=Gk.state.facet(yf)).length?Lk[0](Hk):hb.mac?Hk.metaKey:Hk.ctrlKey),Ik=Ck,Jk=Dk,Mk=Ik.state.facet(zf),this.dragMove=Mk.length?Mk[0](Jk):hb.mac?!Jk.altKey:!Jk.ctrlKey,this.dragging=!!function(a,b){let{main:c}=a.state.selection;if(c.empty)return!1;let d=i(a.root);if(0==d.rangeCount)return!0;let e=d.getRangeAt(0).getClientRects();for(let f=0;f<e.length;f++){let g=e[f];if(g.left<=b.clientX&&g.right>=b.clientX&&g.top<=b.clientY&&g.bottom>=b.clientY)return!0}return!1}(Ck,Dk)&&1==el(Dk)&&null,!1===this.dragging&&(Dk.preventDefault(),this.select(Dk))}move(Nk){if(0==Nk.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=Nk)}up(Ok){null==this.dragging&&this.select(this.lastEvent),this.dragging||Ok.preventDefault(),this.destroy()}destroy(){let Pk=this.view.contentDOM.ownerDocument;Pk.removeEventListener("mousemove",this.move),Pk.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(Qk){let Rk=this.style.get(Qk,this.extend,this.multiple);(this.mustSelect||!Rk.eq(this.view.state.selection)||Rk.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:Rk,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(Sk){Sk.docChanged&&this.dragging&&(this.dragging=this.dragging.map(Sk.changes)),this.style.update(Sk)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Tk(a,b){if(!b.bubbles)return!0;if(b.defaultPrevented)return!1;for(let c=b.target,d;c!=a.contentDOM;c=c.parentNode)if(!c||11==c.nodeType||(d=H.get(c))&&d.ignoreEvent(b))return!1;return!0}const Uk=Object.create(null),Vk=hb.ie&&hb.ie_version<15||hb.ios&&hb.webkit_version<604;function Wk(a,b){let{state:c}=a,e,f=1,g=c.toText(b),h=g.lines==c.selection.ranges.length;if(null!=hl&&c.selection.ranges.every(a=>a.empty)&&hl==g.toString()){let i=-1;e=c.changeByRange(a=>{let e=c.doc.lineAt(a.from);if(e.from==i)return{range:a};i=e.from;let j=c.toText((h?g.line(f++).text:b)+c.lineBreak);return{changes:{from:e.from,insert:j},range:d.jT.cursor(a.from+j.length)}})}else e=h?c.changeByRange(a=>{let b=g.line(f++);return{changes:{from:a.from,to:a.to,insert:b.text},range:d.jT.cursor(a.from+b.length)}}):c.replaceSelection(g);a.dispatch(e,{userEvent:"input.paste",scrollIntoView:!0})}Uk.keydown=(a,b)=>{a.inputState.setSelectionOrigin("select")};let Xk=0;function Yk(a,b,c,f){if(1==f)return d.jT.cursor(b,c);{if(2==f)return(function(a,b,c=1){let f=a.charCategorizer(b),g=a.doc.lineAt(b),h=b-g.from;if(0==g.length)return d.jT.cursor(b);0==h?c=1:h==g.length&&(c=-1);let i=h,j=h;c<0?i=(0,e.cp)(g.text,h,!1):j=(0,e.cp)(g.text,h);let k=f(g.text.slice(i,j));for(;i>0;){let l=(0,e.cp)(g.text,i,!1);if(f(g.text.slice(l,i))!=k)break;i=l}for(;j<g.length;){let m=(0,e.cp)(g.text,j);if(f(g.text.slice(j,m))!=k)break;j=m}return d.jT.range(i+g.from,j+g.from)})(a.state,b,c);let g=Nd.find(a.docView,b),h=a.state.doc.lineAt(g?g.posAtEnd:b),i=g?g.posAtStart:h.from,j=g?g.posAtEnd:h.to;return j<a.state.doc.length&&j==h.to&&j++,d.jT.range(i,j)}}Uk.touchstart=(a,b)=>{Xk=Date.now(),a.inputState.setSelectionOrigin("select.pointer")},Uk.touchmove=a=>{a.inputState.setSelectionOrigin("select.pointer")},Uk.mousedown=(a,b)=>{if(a.observer.flush(),!(Xk>Date.now()-2000)){let c=null;for(let d of a.state.facet(Af))if(c=d(a,b))break;if(c||0!=b.button||(c=fl(a,b)),c){let e=a.root.activeElement!=a.contentDOM;e&&a.observer.ignore(()=>u(a.contentDOM)),a.inputState.startMouseSelection(new Bk(a,b,c,e))}}};let Zk=(a,b)=>a>=b.top&&a<=b.bottom,$k=(a,b,c)=>Zk(b,c)&&a>=c.left&&a<=c.right;function _k(a,b){let c=a.posAtCoords({x:b.clientX,y:b.clientY},!1);return{pos:c,bias:(function(a,b,c,d){let e=Nd.find(a.docView,b);if(!e)return 1;let f=b-e.posAtStart;if(0==f)return 1;if(f==e.length)return -1;let g=e.coordsAt(f,-1);if(g&&$k(c,d,g))return -1;let h=e.coordsAt(f,1);return h&&$k(c,d,h)?1:g&&Zk(d,g)?-1:1})(a,c,b.clientX,b.clientY)}}const al=hb.ie&&hb.ie_version<=11;let bl=null,cl=0,dl=0;function el(a){if(!al)return a.detail;let b=bl,c=dl;return bl=a,dl=Date.now(),cl=!b||c>Date.now()-400&&2>Math.abs(b.clientX-a.clientX)&&2>Math.abs(b.clientY-a.clientY)?(cl+1)%3:1}function fl(a,b){let c=_k(a,b),e=el(b),f=a.state.selection,g=c,h=b;return{update(a){a.docChanged&&(c&&(c.pos=a.changes.mapPos(c.pos)),f=f.map(a.changes),h=null)},get(b,i,j){let k;if(h&&b.clientX==h.clientX&&b.clientY==h.clientY?k=g:(k=g=_k(a,b),h=b),!k||!c)return f;let l=Yk(a,k.pos,k.bias,e);if(c.pos!=k.pos&&!i){let m=Yk(a,c.pos,c.bias,e),n=Math.min(m.from,l.from),o=Math.max(m.to,l.to);l=n<l.from?d.jT.range(n,o):d.jT.range(o,n)}return i?f.replaceRange(f.main.extend(l.from,l.to)):j?f.addRange(l):d.jT.create([l])}}}function gl(a,b,c,d){let e=a.posAtCoords({x:b.clientX,y:b.clientY});if(null!=e&&c){b.preventDefault();let{mouseSelection:f}=a.inputState,g=d&&f&&f.dragging&&f.dragMove?{from:f.dragging.from,to:f.dragging.to}:null,h={from:e,insert:c},i=a.state.changes(g?[g,h]:h);a.focus(),a.dispatch({changes:i,selection:{anchor:i.mapPos(e,-1),head:i.mapPos(e,1)},userEvent:g?"move.drop":"input.drop"})}}Uk.dragstart=(a,b)=>{let{selection:{main:c}}=a.state,{mouseSelection:d}=a.inputState;d&&(d.dragging=c),b.dataTransfer&&(b.dataTransfer.setData("Text",a.state.sliceDoc(c.from,c.to)),b.dataTransfer.effectAllowed="copyMove")},Uk.drop=(a,b)=>{if(b.dataTransfer){if(a.state.readOnly)return b.preventDefault();let c=b.dataTransfer.files;if(c&&c.length){b.preventDefault();let d=Array(c.length),e=0,f=()=>{++e==c.length&&gl(a,b,d.filter(a=>null!=a).join(a.state.lineBreak),!1)};for(let g=0;g<c.length;g++){let h=new FileReader;h.onerror=f,h.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(h.result)||(d[g]=h.result),f()},h.readAsText(c[g])}}else gl(a,b,b.dataTransfer.getData("Text"),!0)}},Uk.paste=(a,b)=>{if(a.state.readOnly)return b.preventDefault();a.observer.flush();let c=Vk?null:b.clipboardData;c?(Wk(a,c.getData("text/plain")),b.preventDefault()):(function(a){let b=a.dom.parentNode;if(b){let c=b.appendChild(document.createElement("textarea"));c.style.cssText="position: fixed; left: -10000px; top: 10px",c.focus(),setTimeout(()=>{a.focus(),c.remove(),Wk(a,c.value)},50)}})(a)};let hl=null;function il(a,b){if(a.docView.compositionDeco.size){a.inputState.rapidCompositionStart=b;try{a.update([])}finally{a.inputState.rapidCompositionStart=!1}}}Uk.copy=Uk.cut=(a,b)=>{let{text:c,ranges:d,linewise:e}=function(a){let b=[],c=[],d=!1;for(let e of a.selection.ranges)e.empty||(b.push(a.sliceDoc(e.from,e.to)),c.push(e));if(!b.length){let f=-1;for(let{from:g}of a.selection.ranges){let h=a.doc.lineAt(g);h.number>f&&(b.push(h.text),c.push({from:h.from,to:Math.min(a.doc.length,h.to+1)})),f=h.number}d=!0}return{text:b.join(a.lineBreak),ranges:c,linewise:d}}(a.state);if(c||e){hl=e?c:null;let f=Vk?null:b.clipboardData;f?(b.preventDefault(),f.clearData(),f.setData("text/plain",c)):(function(a,b){let c=a.dom.parentNode;if(c){let d=c.appendChild(document.createElement("textarea"));d.style.cssText="position: fixed; left: -10000px; top: 10px",d.value=b,d.focus(),d.selectionEnd=b.length,d.selectionStart=0,setTimeout(()=>{d.remove(),a.focus()},50)}})(a,c),"cut"!=b.type||a.state.readOnly||a.dispatch({changes:d,scrollIntoView:!0,userEvent:"delete.cut"})}},Uk.focus=Uk.blur=a=>{setTimeout(()=>{a.hasFocus!=a.inputState.notifiedFocused&&a.update([])},10)},Uk.beforeprint=a=>{a.viewState.printing=!0,a.requestMeasure(),setTimeout(()=>{a.viewState.printing=!1,a.requestMeasure()},2000)},Uk.compositionstart=Uk.compositionupdate=a=>{null==a.inputState.compositionFirstChange&&(a.inputState.compositionFirstChange=!0),a.inputState.composing<0&&(a.inputState.composing=0,a.docView.compositionDeco.size&&(a.observer.flush(),il(a,!0)))},Uk.compositionend=a=>{a.inputState.composing=-1,a.inputState.compositionEndedAt=Date.now(),a.inputState.compositionFirstChange=null,setTimeout(()=>{a.inputState.composing<0&&il(a,!1)},50)},Uk.contextmenu=a=>{a.inputState.lastContextMenu=Date.now()},Uk.beforeinput=(a,b)=>{var c;let d;if(hb.chrome&&hb.android&&(d=zk.find(a=>a.inputType==b.inputType))&&(a.observer.delayAndroidKey(d.key,d.keyCode),"Backspace"==d.key||"Delete"==d.key)){let e=(null===(c=window.visualViewport)|| void 0===c?void 0:c.height)||0;setTimeout(()=>{var b;((null===(b=window.visualViewport)|| void 0===b?void 0:b.height)||0)>e+10&&a.hasFocus&&(a.contentDOM.blur(),a.focus())},100)}};const jl=["pre-wrap","normal","pre-line","break-spaces"];class kl{constructor(ll,ml){this.from=ll,this.heights=ml,this.index=0}get more(){return this.index<this.heights.length}}class nl{constructor(ol,pl,ql,rl,sl){this.from=ol,this.length=pl,this.top=ql,this.height=rl,this.type=sl}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(tl){let ul=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(tl.type)?tl.type:[tl]);return new nl(this.from,this.length+tl.length,this.top,this.height+tl.height,ul)}moveY(vl){return vl?new nl(this.from,this.length,this.top+vl,this.height,Array.isArray(this.type)?this.type.map(a=>a.moveY(vl)):this.type):this}}var wl,xl=((wl=xl||(xl={}))[wl.ByPos=0]="ByPos",wl[wl.ByHeight=1]="ByHeight",wl[wl.ByPosNoHeight=2]="ByPosNoHeight",wl);class yl{constructor(zl,Al,Bl=2){this.length=zl,this.height=Al,this.flags=Bl}get outdated(){return(2&this.flags)>0}set outdated(Cl){this.flags=(Cl?2:0)| -3&this.flags}setHeight(Dl,El){this.height!=El&&(Math.abs(this.height-El)>0.001&&(Dl.heightChanged=!0),this.height=El)}replace(Fl,Gl,Hl){return yl.of(Hl)}decomposeLeft(Il,Jl){Jl.push(this)}decomposeRight(Kl,Ll){Ll.push(this)}applyChanges(Ml,Nl,Ol,Pl){let Ql=this;for(let Rl=Pl.length-1;Rl>=0;Rl--){let{fromA:Sl,toA:Tl,fromB:Ul,toB:Vl}=Pl[Rl],Wl=Ql.lineAt(Sl,xl.ByPosNoHeight,Nl,0,0),Xl=Wl.to>=Tl?Wl:Ql.lineAt(Tl,xl.ByPosNoHeight,Nl,0,0);for(Vl+=Xl.to-Tl,Tl=Xl.to;Rl>0&&Wl.from<=Pl[Rl-1].toA;)Sl=Pl[Rl-1].fromA,Ul=Pl[Rl-1].fromB,Rl--,Sl<Wl.from&&(Wl=Ql.lineAt(Sl,xl.ByPosNoHeight,Nl,0,0));Ul+=Wl.from-Sl,Sl=Wl.from;let Yl=Zo.build(Ol,Ml,Ul,Vl);Ql=Ql.replace(Sl,Tl,Yl)}return Ql.updateHeight(Ol,0)}static empty(){return new Em(0,0)}static of(Zl){if(1==Zl.length)return Zl[0];let $l=0,_l=Zl.length,am=0,bm=0;for(;;)if($l==_l)if(am>2*bm){let cm=Zl[$l-1];cm.break?Zl.splice(--$l,1,cm.left,null,cm.right):Zl.splice(--$l,1,cm.left,cm.right),_l+=1+cm.break,am-=cm.size}else if(bm>2*am){let dm=Zl[_l];dm.break?Zl.splice(_l,1,dm.left,null,dm.right):Zl.splice(_l,1,dm.left,dm.right),_l+=2+dm.break,bm-=dm.size}else break;else if(am<bm){let em=Zl[$l++];em&&(am+=em.size)}else{let fm=Zl[--_l];fm&&(bm+=fm.size)}let gm=0;return null==Zl[$l-1]?(gm=1,$l--):null==Zl[$l]&&(gm=1,_l++),new Yn(yl.of(Zl.slice(0,$l)),gm,yl.of(Zl.slice(_l)))}}yl.prototype.size=1;class hm extends yl{constructor(im,jm,km){super(im,jm),this.type=km}blockAt(lm,mm,nm,om){return new nl(om,this.length,nm,this.height,this.type)}lineAt(pm,qm,rm,sm,tm){return this.blockAt(0,rm,sm,tm)}forEachLine(um,vm,wm,xm,ym,zm){zm(this.blockAt(0,wm,xm,ym))}updateHeight(Am,Bm=0,Cm=!1,Dm){return Dm&&Dm.from<=Bm&&Dm.more&&this.setHeight(Am,Dm.heights[Dm.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Em extends hm{constructor(Fm,Gm){super(Fm,Gm,Zc.Text),this.collapsed=0,this.widgetHeight=0}replace(Hm,Im,Jm){let Km=Jm[0];return 1==Jm.length&&(Km instanceof Em||Km instanceof Pm&&4&Km.flags)&&10>Math.abs(this.length-Km.length)?(Km instanceof Pm?Km=new Em(Km.length,this.height):Km.height=this.height,this.outdated||(Km.outdated=!1),Km):yl.of(Jm)}updateHeight(Lm,Mm=0,Nm=!1,Om){return Om&&Om.from<=Mm&&Om.more?this.setHeight(Lm,Om.heights[Om.index++]):(Nm||this.outdated)&&this.setHeight(Lm,Math.max(this.widgetHeight,Lm.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Pm extends yl{constructor(Qm){super(Qm,0)}lines(Rm,Sm){let Tm=Rm.lineAt(Sm).number,Um=Rm.lineAt(Sm+this.length).number;return{firstLine:Tm,lastLine:Um,lineHeight:this.height/(Um-Tm+1)}}blockAt(Vm,Wm,Xm,Ym){let{firstLine:Zm,lastLine:$m,lineHeight:_m}=this.lines(Wm,Ym),an=Math.max(0,Math.min($m-Zm,Math.floor((Vm-Xm)/_m))),{from:bn,length:cn}=Wm.line(Zm+an);return new nl(bn,cn,Xm+_m*an,_m,Zc.Text)}lineAt(dn,en,fn,gn,hn){if(en==xl.ByHeight)return this.blockAt(dn,fn,gn,hn);if(en==xl.ByPosNoHeight){let{from:jn,to:kn}=fn.lineAt(dn);return new nl(jn,kn-jn,0,0,Zc.Text)}let{firstLine:ln,lineHeight:mn}=this.lines(fn,hn),{from:nn,length:on,number:pn}=fn.lineAt(dn);return new nl(nn,on,gn+mn*(pn-ln),mn,Zc.Text)}forEachLine(qn,rn,sn,tn,un,vn){let{firstLine:wn,lineHeight:xn}=this.lines(sn,un);for(let yn=Math.max(qn,un),zn=Math.min(un+this.length,rn);yn<=zn;){let An=sn.lineAt(yn);yn==qn&&(tn+=xn*(An.number-wn)),vn(new nl(An.from,An.length,tn,xn,Zc.Text)),tn+=xn,yn=An.to+1}}replace(Bn,Cn,Dn){let En=this.length-Cn;if(En>0){let Fn=Dn[Dn.length-1];Fn instanceof Pm?Dn[Dn.length-1]=new Pm(Fn.length+En):Dn.push(null,new Pm(En-1))}if(Bn>0){let Gn=Dn[0];Gn instanceof Pm?Dn[0]=new Pm(Bn+Gn.length):Dn.unshift(new Pm(Bn-1),null)}return yl.of(Dn)}decomposeLeft(Hn,In){In.push(new Pm(Hn-1),null)}decomposeRight(Jn,Kn){Kn.push(null,new Pm(this.length-Jn-1))}updateHeight(Ln,Mn=0,Nn=!1,On){let Pn=Mn+this.length;if(On&&On.from<=Mn+this.length&&On.more){let Qn=[],Rn=Math.max(Mn,On.from),Sn=-1,Tn=Ln.heightChanged;for(On.from>Mn&&Qn.push(new Pm(On.from-Mn-1).updateHeight(Ln,Mn));Rn<=Pn&&On.more;){let Un=Ln.doc.lineAt(Rn).length;Qn.length&&Qn.push(null);let Vn=On.heights[On.index++];-1==Sn?Sn=Vn:Math.abs(Vn-Sn)>=0.001&&(Sn=-2);let Wn=new Em(Un,Vn);Wn.outdated=!1,Qn.push(Wn),Rn+=Un+1}Rn<=Pn&&Qn.push(null,new Pm(Pn-Rn).updateHeight(Ln,Rn));let Xn=yl.of(Qn);return Ln.heightChanged=Tn||Sn<0||Math.abs(Xn.height-this.height)>=0.001||Math.abs(Sn-this.lines(Ln.doc,Mn).lineHeight)>=0.001,Xn}return(Nn||this.outdated)&&(this.setHeight(Ln,Ln.heightForGap(Mn,Mn+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class Yn extends yl{constructor(Zn,$n,_n){super(Zn.length+$n+_n.length,Zn.height+_n.height,$n|(Zn.outdated||_n.outdated?2:0)),this.left=Zn,this.right=_n,this.size=Zn.size+_n.size}get break(){return 1&this.flags}blockAt(ao,bo,co,eo){let fo=co+this.left.height;return ao<fo?this.left.blockAt(ao,bo,co,eo):this.right.blockAt(ao,bo,fo,eo+this.left.length+this.break)}lineAt(go,ho,io,jo,ko){let lo=jo+this.left.height,mo=ko+this.left.length+this.break,no=ho==xl.ByHeight?go<lo:go<mo,oo=no?this.left.lineAt(go,ho,io,jo,ko):this.right.lineAt(go,ho,io,lo,mo);if(this.break||(no?oo.to<mo:oo.from>mo))return oo;let po=ho==xl.ByPosNoHeight?xl.ByPosNoHeight:xl.ByPos;return no?oo.join(this.right.lineAt(mo,po,io,lo,mo)):this.left.lineAt(mo,po,io,jo,ko).join(oo)}forEachLine(qo,ro,so,to,uo,vo){let wo=to+this.left.height,xo=uo+this.left.length+this.break;if(this.break)qo<xo&&this.left.forEachLine(qo,ro,so,to,uo,vo),ro>=xo&&this.right.forEachLine(qo,ro,so,wo,xo,vo);else{let yo=this.lineAt(xo,xl.ByPos,so,to,uo);qo<yo.from&&this.left.forEachLine(qo,yo.from-1,so,to,uo,vo),yo.to>=qo&&yo.from<=ro&&vo(yo),ro>yo.to&&this.right.forEachLine(yo.to+1,ro,so,wo,xo,vo)}}replace(zo,Ao,Bo){let Co=this.left.length+this.break;if(Ao<Co)return this.balanced(this.left.replace(zo,Ao,Bo),this.right);if(zo>this.left.length)return this.balanced(this.left,this.right.replace(zo-Co,Ao-Co,Bo));let Do=[];zo>0&&this.decomposeLeft(zo,Do);let Eo=Do.length;for(let Fo of Bo)Do.push(Fo);if(zo>0&&Yo(Do,Eo-1),Ao<this.length){let Go=Do.length;this.decomposeRight(Ao,Do),Yo(Do,Go)}return yl.of(Do)}decomposeLeft(Ho,Io){let Jo=this.left.length;if(Ho<=Jo)return this.left.decomposeLeft(Ho,Io);Io.push(this.left),this.break&&(Jo++,Ho>=Jo&&Io.push(null)),Ho>Jo&&this.right.decomposeLeft(Ho-Jo,Io)}decomposeRight(Ko,Lo){let Mo=this.left.length,No=Mo+this.break;if(Ko>=No)return this.right.decomposeRight(Ko-No,Lo);Ko<Mo&&this.left.decomposeRight(Ko,Lo),this.break&&Ko<No&&Lo.push(null),Lo.push(this.right)}balanced(Oo,Po){return Oo.size>2*Po.size||Po.size>2*Oo.size?yl.of(this.break?[Oo,null,Po]:[Oo,Po]):(this.left=Oo,this.right=Po,this.height=Oo.height+Po.height,this.outdated=Oo.outdated||Po.outdated,this.size=Oo.size+Po.size,this.length=Oo.length+this.break+Po.length,this)}updateHeight(Qo,Ro=0,So=!1,To){let{left:Uo,right:Vo}=this,Wo=Ro+Uo.length+this.break,Xo=null;return(To&&To.from<=Ro+Uo.length&&To.more?Xo=Uo=Uo.updateHeight(Qo,Ro,So,To):Uo.updateHeight(Qo,Ro,So),To&&To.from<=Wo+Vo.length&&To.more?Xo=Vo=Vo.updateHeight(Qo,Wo,So,To):Vo.updateHeight(Qo,Wo,So),Xo)?this.balanced(Uo,Vo):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Yo(a,b){let c,d;null==a[b]&&(c=a[b-1])instanceof Pm&&(d=a[b+1])instanceof Pm&&a.splice(b-1,3,new Pm(c.length+1+d.length))}class Zo{constructor($o,_o){this.pos=$o,this.oracle=_o,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=$o}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(ap,bp){if(this.lineStart> -1){let cp=Math.min(bp,this.lineEnd),dp=this.nodes[this.nodes.length-1];dp instanceof Em?dp.length+=cp-this.pos:(cp>this.pos||!this.isCovered)&&this.nodes.push(new Em(cp-this.pos,-1)),this.writtenTo=cp,bp>cp&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=bp}point(ep,fp,gp){if(ep<fp||gp.heightRelevant){let hp=gp.widget?gp.widget.estimatedHeight:0;hp<0&&(hp=this.oracle.lineHeight);let ip=fp-ep;gp.block?this.addBlock(new hm(ip,hp,gp.type)):(ip||hp>=5)&&this.addLineDeco(hp,ip)}else fp>ep&&this.span(ep,fp);this.lineEnd> -1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(!(this.lineStart> -1)){let{from:jp,to:kp}=this.oracle.doc.lineAt(this.pos);this.lineStart=jp,this.lineEnd=kp,this.writtenTo<jp&&((this.writtenTo<jp-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,jp-1)),this.nodes.push(null)),this.pos>jp&&this.nodes.push(new Em(this.pos-jp,-1)),this.writtenTo=this.pos}}blankContent(lp,mp){let np=new Pm(mp-lp);return this.oracle.doc.lineAt(lp).to==mp&&(np.flags|=4),np}ensureLine(){this.enterLine();let op=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(op instanceof Em)return op;let pp=new Em(0,-1);return this.nodes.push(pp),pp}addBlock(qp){this.enterLine(),qp.type!=Zc.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(qp),this.writtenTo=this.pos=this.pos+qp.length,qp.type!=Zc.WidgetBefore&&(this.covering=qp)}addLineDeco(rp,sp){let tp=this.ensureLine();tp.length+=sp,tp.collapsed+=sp,tp.widgetHeight=Math.max(tp.widgetHeight,rp),this.writtenTo=this.pos=this.pos+sp}finish(up){let vp=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart> -1)||vp instanceof Em||this.isCovered?(this.writtenTo<this.pos||null==vp)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new Em(0,-1));let wp=up;for(let xp of this.nodes)xp instanceof Em&&xp.updateHeight(this.oracle,wp),wp+=xp?xp.length:1;return this.nodes}static build(yp,zp,Ap,Bp){let Cp=new Zo(Ap,yp);return g.Xs.spans(zp,Ap,Bp,Cp,0),Cp.finish(Ap)}}class Dp{constructor(){this.changes=[]}compareRange(){}comparePoint(Ep,Fp,Gp,Hp){(Ep<Fp||Gp&&Gp.heightRelevant||Hp&&Hp.heightRelevant)&&Md(Ep,Fp,this.changes,5)}}class Ip{constructor(Jp,Kp,Lp){this.from=Jp,this.to=Kp,this.size=Lp}static same(Mp,Np){if(Mp.length!=Np.length)return!1;for(let Op=0;Op<Mp.length;Op++){let Pp=Mp[Op],Qp=Np[Op];if(Pp.from!=Qp.from||Pp.to!=Qp.to||Pp.size!=Qp.size)return!1}return!0}draw(Rp){return $c.replace({widget:new Sp(this.size,Rp)}).range(this.from,this.to)}}class Sp extends Sc{constructor(Tp,Up){super(),this.size=Tp,this.vertical=Up}eq(Vp){return Vp.size==this.size&&Vp.vertical==this.vertical}toDOM(){let Wp=document.createElement("div");return this.vertical?Wp.style.height=this.size+"px":(Wp.style.width=this.size+"px",Wp.style.height="2px",Wp.style.display="inline-block"),Wp}get estimatedHeight(){return this.vertical?this.size:-1}}class Xp{constructor(Yp,Zp=!1){this.range=Yp,this.center=Zp}map($p){return $p.empty?this:new Xp(this.range.map($p),this.center)}}class _p{constructor(aq){this.state=aq,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.heightOracle=new class{constructor(){this.doc=e.xv.empty,this.lineWrapping=!1,this.direction=Zg.LTR,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(bq,cq){let dq=this.doc.lineAt(cq).number-this.doc.lineAt(bq).number+1;return this.lineWrapping&&(dq+=Math.ceil((cq-bq-dq*this.lineLength*0.5)/this.lineLength)),this.lineHeight*dq}heightForLine(eq){return this.lineWrapping?(1+Math.max(0,Math.ceil((eq-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(fq){return this.doc=fq,this}mustRefreshForStyle(gq,hq){return jl.indexOf(gq)> -1!=this.lineWrapping||this.direction!=hq}mustRefreshForHeights(iq){let jq=!1;for(let kq=0;kq<iq.length;kq++){let lq=iq[kq];lq<0?kq++:this.heightSamples[Math.floor(10*lq)]||(jq=!0,this.heightSamples[Math.floor(10*lq)]=!0)}return jq}refresh(mq,nq,oq,pq,qq,rq){let sq=jl.indexOf(mq)> -1,tq=Math.round(oq)!=Math.round(this.lineHeight)||this.lineWrapping!=sq||this.direction!=nq;if(this.lineWrapping=sq,this.direction=nq,this.lineHeight=oq,this.charWidth=pq,this.lineLength=qq,tq){this.heightSamples={};for(let uq=0;uq<rq.length;uq++){let vq=rq[uq];vq<0?uq++:this.heightSamples[Math.floor(10*vq)]=!0}}return tq}},this.scaler=ns,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.heightMap=yl.empty().applyChanges(aq.facet(rg),e.xv.empty,this.heightOracle.setDoc(aq.doc),[new tg(0,0,0,aq.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=$c.set(this.lineGaps.map(a=>a.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let wq=[this.viewport],{main:xq}=this.state.selection;for(let yq=0;yq<=1;yq++){let zq=yq?xq.head:xq.anchor;if(!wq.some(({from:a,to:b})=>zq>=a&&zq<=b)){let{from:Aq,to:Bq}=this.lineBlockAt(zq);wq.push(new fs(Aq,Bq))}}this.viewports=wq.sort((a,b)=>a.from-b.from),this.scaler=this.heightMap.height<=70e5?ns:new os(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,a=>{this.viewportLines.push(1==this.scaler.scale?a:Gs(a,this.scaler))})}update(Cq,Dq=null){var Eq,Fq,Gq;let Hq=this.state;this.state=Cq.state;let Iq=this.state.facet(rg),Jq=Cq.changedRanges,Kq,Lq=tg.extendWithRanges(Jq,(Eq=Cq.startState.facet(rg),Fq=Iq,Gq=Cq?Cq.changes:d.as.empty(this.state.doc.length),Kq=new Dp,g.Xs.compare(Eq,Fq,Gq,Kq,0),Kq.changes)),Mq=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(Iq,Hq.doc,this.heightOracle.setDoc(this.state.doc),Lq),this.heightMap.height!=Mq&&(Cq.flags|=2);let Nq=Lq.length?this.mapViewport(this.viewport,Cq.changes):this.viewport;(Dq&&(Dq.range.head<Nq.from||Dq.range.head>Nq.to)||!this.viewportIsAppropriate(Nq))&&(Nq=this.getViewport(0,Dq));let Oq=!Cq.changes.empty||2&Cq.flags||Nq.from!=this.viewport.from||Nq.to!=this.viewport.to;this.viewport=Nq,Oq&&this.updateViewportLines(),this.updateForViewport(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4000)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,Cq.changes))),Cq.flags|=this.computeVisibleRanges(),Dq&&(this.scrollTarget=Dq),!this.mustEnforceCursorAssoc&&Cq.selectionSet&&Cq.view.lineWrapping&&Cq.state.selection.main.empty&&Cq.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(Pq){let Qq=Pq.contentDOM,Rq=window.getComputedStyle(Qq),Sq=this.heightOracle,Tq=Rq.whiteSpace,Uq="rtl"==Rq.direction?Zg.RTL:Zg.LTR,Vq=this.heightOracle.mustRefreshForStyle(Tq,Uq),Wq=Vq||this.mustMeasureContent||this.contentDOMHeight!=Qq.clientHeight,Xq=0,Yq=0;if(Wq){this.mustMeasureContent=!1,this.contentDOMHeight=Qq.clientHeight;let Zq=parseInt(Rq.paddingTop)||0,$q=parseInt(Rq.paddingBottom)||0;(this.paddingTop!=Zq||this.paddingBottom!=$q)&&(Xq|=8,this.paddingTop=Zq,this.paddingBottom=$q)}let _q=this.printing?{top:-10e7,bottom:10e7,left:-10e7,right:10e7}:function(a,b){let c=a.getBoundingClientRect(),d=Math.max(0,c.left),e=Math.min(innerWidth,c.right),f=Math.max(0,c.top),g=Math.min(innerHeight,c.bottom),h=a.ownerDocument.body;for(let i=a.parentNode;i&&i!=h;)if(1==i.nodeType){let j=i,k=window.getComputedStyle(j);if((j.scrollHeight>j.clientHeight||j.scrollWidth>j.clientWidth)&&"visible"!=k.overflow){let l=j.getBoundingClientRect();d=Math.max(d,l.left),e=Math.min(e,l.right),f=Math.max(f,l.top),g=Math.min(g,l.bottom)}i="absolute"==k.position||"fixed"==k.position?j.offsetParent:j.parentNode}else if(11==i.nodeType)i=i.host;else break;return{left:d-c.left,right:Math.max(d,e)-c.left,top:f-(c.top+b),bottom:Math.max(f,g)-(c.top+b)}}(Qq,this.paddingTop),ar=_q.top-this.pixelViewport.top,br=_q.bottom-this.pixelViewport.bottom;if(this.pixelViewport=_q,this.inView=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left,!this.inView)return 0;if(Wq){let cr=Pq.docView.measureVisibleLineHeights();Sq.mustRefreshForHeights(cr)&&(Vq=!0);let dr=Qq.clientWidth;if(Vq||Sq.lineWrapping&&Math.abs(dr-this.contentDOMWidth)>Sq.charWidth){let{lineHeight:er,charWidth:fr}=Pq.docView.measureTextSize();(Vq=Sq.refresh(Tq,Uq,er,fr,dr/fr,cr))&&(Pq.docView.minWidth=0,Xq|=8)}this.contentDOMWidth!=dr&&(this.contentDOMWidth=dr,Xq|=8),this.editorHeight!=Pq.scrollDOM.clientHeight&&(this.editorHeight=Pq.scrollDOM.clientHeight,Xq|=8),ar>0&&br>0?Yq=Math.max(ar,br):ar<0&&br<0&&(Yq=Math.min(ar,br)),Sq.heightChanged=!1,this.heightMap=this.heightMap.updateHeight(Sq,0,Vq,new kl(this.viewport.from,cr)),Sq.heightChanged&&(Xq|=2)}let gr=!this.viewportIsAppropriate(this.viewport,Yq)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return gr&&(this.viewport=this.getViewport(Yq,this.scrollTarget)),(2&Xq||gr)&&this.updateViewportLines(),this.updateForViewport(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4000)&&this.updateLineGaps(this.ensureLineGaps(Vq?[]:this.lineGaps)),Xq|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,Pq.docView.enforceCursorAssoc()),Xq}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(hr,ir){let jr=0.5-Math.max(-0.5,Math.min(0.5,hr/1000/2)),kr=this.heightMap,lr=this.state.doc,{visibleTop:mr,visibleBottom:nr}=this,or=new fs(kr.lineAt(mr-1000*jr,xl.ByHeight,lr,0,0).from,kr.lineAt(nr+(1-jr)*1000,xl.ByHeight,lr,0,0).to);if(ir){let{head:pr}=ir.range,qr=this.editorHeight;if(pr<or.from||pr>or.to){let rr=kr.lineAt(pr,xl.ByPos,lr,0,0),sr;sr=ir.center?(rr.top+rr.bottom)/2-qr/2:pr<or.from?rr.top:rr.bottom-qr,or=new fs(kr.lineAt(sr-500,xl.ByHeight,lr,0,0).from,kr.lineAt(sr+qr+500,xl.ByHeight,lr,0,0).to)}}return or}mapViewport(tr,ur){let vr=ur.mapPos(tr.from,-1),wr=ur.mapPos(tr.to,1);return new fs(this.heightMap.lineAt(vr,xl.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(wr,xl.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:xr,to:yr},zr=0){if(!this.inView)return!0;let{top:Ar}=this.heightMap.lineAt(xr,xl.ByPos,this.state.doc,0,0),{bottom:Br}=this.heightMap.lineAt(yr,xl.ByPos,this.state.doc,0,0),{visibleTop:Cr,visibleBottom:Dr}=this;return(0==xr||Ar<=Cr-Math.max(10,Math.min(-zr,250)))&&(yr==this.state.doc.length||Br>=Dr+Math.max(10,Math.min(zr,250)))&&Ar>Cr-2000&&Br<Dr+2000}mapLineGaps(Er,Fr){if(!Er.length||Fr.empty)return Er;let Gr=[];for(let Hr of Er)Fr.touchesRange(Hr.from,Hr.to)||Gr.push(new Ip(Fr.mapPos(Hr.from),Fr.mapPos(Hr.to),Hr.size));return Gr}ensureLineGaps(Ir){let Jr=[];if(this.heightOracle.direction!=Zg.LTR)return Jr;for(let Kr of this.viewportLines)if(!(Kr.length<4000)){let Lr=is(Kr.from,Kr.to,this.state);if(!(Lr.total<4000)){let Mr,Nr;if(this.heightOracle.lineWrapping){let Or=2000/this.heightOracle.lineLength*this.heightOracle.lineHeight;Mr=js(Lr,(this.visibleTop-Kr.top-Or)/Kr.height),Nr=js(Lr,(this.visibleBottom-Kr.top+Or)/Kr.height)}else{let Pr=Lr.total*this.heightOracle.charWidth,Qr=2000*this.heightOracle.charWidth;Mr=js(Lr,(this.pixelViewport.left-Qr)/Pr),Nr=js(Lr,(this.pixelViewport.right+Qr)/Pr)}let Rr=[];Mr>Kr.from&&Rr.push({from:Kr.from,to:Mr}),Nr<Kr.to&&Rr.push({from:Nr,to:Kr.to});let Sr=this.state.selection.main;for(let{from:Tr,to:Ur}of(Sr.from>=Kr.from&&Sr.from<=Kr.to&&ls(Rr,Sr.from-10,Sr.from+10),!Sr.empty&&Sr.to>=Kr.from&&Sr.to<=Kr.to&&ls(Rr,Sr.to-10,Sr.to+10),Rr))Ur-Tr>1000&&Jr.push(ms(Ir,a=>a.from>=Kr.from&&a.to<=Kr.to&&1000>Math.abs(a.from-Tr)&&1000>Math.abs(a.to-Ur))||new Ip(Tr,Ur,this.gapSize(Kr,Tr,Ur,Lr)))}}return Jr}gapSize(Vr,Wr,Xr,Yr){let Zr=ks(Yr,Xr)-ks(Yr,Wr);return this.heightOracle.lineWrapping?Vr.height*Zr:Yr.total*this.heightOracle.charWidth*Zr}updateLineGaps($r){Ip.same($r,this.lineGaps)||(this.lineGaps=$r,this.lineGapDeco=$c.set($r.map(a=>a.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let _r=this.state.facet(rg);this.lineGaps.length&&(_r=_r.concat(this.lineGapDeco));let as=[];g.Xs.spans(_r,this.viewport.from,this.viewport.to,{span(a,b){as.push({from:a,to:b})},point(){}},20);let bs=as.length!=this.visibleRanges.length||this.visibleRanges.some((a,b)=>a.from!=as[b].from||a.to!=as[b].to);return this.visibleRanges=as,bs?4:0}lineBlockAt(cs){return cs>=this.viewport.from&&cs<=this.viewport.to&&this.viewportLines.find(a=>a.from<=cs&&a.to>=cs)||Gs(this.heightMap.lineAt(cs,xl.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(ds){return Gs(this.heightMap.lineAt(this.scaler.fromDOM(ds),xl.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(es){return Gs(this.heightMap.blockAt(this.scaler.fromDOM(es),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class fs{constructor(gs,hs){this.from=gs,this.to=hs}}function is(a,b,c){let d=[],e=a,f=0;return g.Xs.spans(c.facet(rg),a,b,{span(){},point(a,b){a>e&&(d.push({from:e,to:a}),f+=a-e),e=b}},20),e<b&&(d.push({from:e,to:b}),f+=b-e),{total:f,ranges:d}}function js({total:a,ranges:b},c){if(c<=0)return b[0].from;if(c>=1)return b[b.length-1].to;let d=Math.floor(a*c);for(let e=0;;e++){let{from:f,to:g}=b[e],h=g-f;if(d<=h)return f+d;d-=h}}function ks(a,b){let c=0;for(let{from:d,to:e}of a.ranges){if(b<=e){c+=b-d;break}c+=e-d}return c/a.total}function ls(a,b,c){for(let d=0;d<a.length;d++){let e=a[d];if(e.from<c&&e.to>b){let f=[];e.from<b&&f.push({from:e.from,to:b}),e.to>c&&f.push({from:c,to:e.to}),a.splice(d,1,...f),d+=f.length-1}}}function ms(a,b){for(let c of a)if(b(c))return c}const ns={toDOM(a){return a},fromDOM(a){return a},scale:1};class os{constructor(ps,qs,rs){let ss=0,ts=0,us=0;for(let vs of(this.viewports=rs.map(({from:a,to:b})=>{let c=qs.lineAt(a,xl.ByPos,ps,0,0).top,d=qs.lineAt(b,xl.ByPos,ps,0,0).bottom;return ss+=d-c,{from:a,to:b,top:c,bottom:d,domTop:0,domBottom:0}}),this.scale=(70e5-ss)/(qs.height-ss),this.viewports))vs.domTop=us+(vs.top-ts)*this.scale,us=vs.domBottom=vs.domTop+(vs.bottom-vs.top),ts=vs.bottom}toDOM(ws){for(let xs=0,ys=0,zs=0;;xs++){let As=xs<this.viewports.length?this.viewports[xs]:null;if(!As||ws<As.top)return zs+(ws-ys)*this.scale;if(ws<=As.bottom)return As.domTop+(ws-As.top);ys=As.bottom,zs=As.domBottom}}fromDOM(Bs){for(let Cs=0,Ds=0,Es=0;;Cs++){let Fs=Cs<this.viewports.length?this.viewports[Cs]:null;if(!Fs||Bs<Fs.domTop)return Ds+(Bs-Es)/this.scale;if(Bs<=Fs.domBottom)return Fs.top+(Bs-Fs.domTop);Ds=Fs.bottom,Es=Fs.domBottom}}}function Gs(a,b){if(1==b.scale)return a;let c=b.toDOM(a.top),d=b.toDOM(a.bottom);return new nl(a.from,a.length,c,d-c,Array.isArray(a.type)?a.type.map(a=>Gs(a,b)):a.type)}const Hs=d.r$.define({combine:a=>a.join(" ")}),Is=d.r$.define({combine:a=>a.indexOf(!0)> -1}),Js=f.V.newName(),Ks=f.V.newName(),Ls=f.V.newName(),Ms={"&light":"."+Ks,"&dark":"."+Ls};function Ns(a,b,c){return new f.V(b,{finish(b){return/&/.test(b)?b.replace(/&\w*/,b=>{if("&"==b)return a;if(!c||!c[b])throw new RangeError(`Unsupported selector: ${b}`);return c[b]}):a+" "+b}})}const Os=Ns("."+Js,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Ms),Ps={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Qs=hb.ie&&hb.ie_version<=11;function Rs(a,b,c){for(;b;){let d=H.get(b);if(d&&d.parent==a)return d;let e=b.parentNode;b=e!=a.dom?e:c>0?b.nextSibling:b.previousSibling}return null}class Ss{constructor(Ts={}){for(let Us of(this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=Ts.dispatch||(a=>this.update([a])),this.dispatch=this.dispatch.bind(this),this.root=Ts.root||(function(a){for(;a;){if(a&&(9==a.nodeType||11==a.nodeType&&a.host))return a;a=a.assignedSlot||a.parentNode}return null})(Ts.parent)||document,this.viewState=new _p(Ts.state||d.yy.create()),this.plugins=this.state.facet(Of).map(a=>new bg(a)),this.plugins))Us.update(this);this.observer=new class{constructor(Vs,Ws,Xs){this.view=Vs,this.onChange=Ws,this.onScrollChanged=Xs,this.active=!1,this.selectionRange=new class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(Ys){return this.anchorNode==Ys.anchorNode&&this.anchorOffset==Ys.anchorOffset&&this.focusNode==Ys.focusNode&&this.focusOffset==Ys.focusOffset}setRange(Zs){this.set(Zs.anchorNode,Zs.anchorOffset,Zs.focusNode,Zs.focusOffset)}set($s,_s,at,bt){this.anchorNode=$s,this.anchorOffset=_s,this.focusNode=at,this.focusOffset=bt}},this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=Vs.contentDOM,this.observer=new MutationObserver(a=>{for(let b of a)this.queue.push(b);(hb.ie&&hb.ie_version<=11||hb.ios&&Vs.composing)&&a.some(a=>"childList"==a.type&&a.removedNodes.length||"characterData"==a.type&&a.oldValue.length>a.target.nodeValue.length)?this.flushSoon():this.flush()}),Qs&&(this.onCharData=a=>{this.queue.push({target:a.target,type:"characterData",oldValue:a.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver(()=>{this.view.docView.lastUpdate<Date.now()-75&&this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}),this.resize.observe(Vs.scrollDOM)),this.start(),this.onScroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onScroll),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(a=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1000)),a.length>0&&a[a.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(a=>{a.length>0&&a[a.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(ct){this.intersecting&&this.flush(!1),this.onScrollChanged(ct)}updateGaps(dt){if(this.gapIntersection&&(dt.length!=this.gaps.length||this.gaps.some((a,b)=>a!=dt[b]))){for(let et of(this.gapIntersection.disconnect(),dt))this.gapIntersection.observe(et);this.gaps=dt}}onSelectionChange(ft){if(this.readSelectionRange()&&!this.delayedAndroidKey){let{view:gt}=this,ht=this.selectionRange;if(gt.state.facet(Hf)?gt.root.activeElement==this.dom:!!k(gt.dom,ht)){let it=ht.anchorNode&&gt.docView.nearest(ht.anchorNode);it&&it.ignoreEvent(ft)||(hb.ie&&hb.ie_version<=11&&!gt.state.selection.main.empty&&ht.focusNode&&m(ht.focusNode,ht.focusOffset,ht.anchorNode,ht.anchorOffset)?this.flushSoon():this.flush(!1))}}}readSelectionRange(){let{root:jt}=this.view,kt=i(jt),lt=hb.safari&&11==jt.nodeType&&function(){let a=document.activeElement;for(;a&&a.shadowRoot;)a=a.shadowRoot.activeElement;return a}()==this.view.contentDOM&&function(a){let b=null;function c(a){a.preventDefault(),a.stopImmediatePropagation(),b=a.getTargetRanges()[0]}if(a.contentDOM.addEventListener("beforeinput",c,!0),document.execCommand("indent"),a.contentDOM.removeEventListener("beforeinput",c,!0),!b)return null;let d=b.startContainer,e=b.startOffset,f=b.endContainer,g=b.endOffset,h=a.docView.domAtPos(a.state.selection.main.anchor);return m(h.node,h.offset,f,g)&&([d,e,f,g]=[f,g,d,e]),{anchorNode:d,anchorOffset:e,focusNode:f,focusOffset:g}}(this.view)||kt;return!this.selectionRange.eq(lt)&&(this.selectionRange.setRange(lt),this.selectionChanged=!0)}setSelectionRange(mt,nt){this.selectionRange.set(mt.node,mt.offset,nt.node,nt.offset),this.selectionChanged=!1}listenForScroll(){this.parentCheck=-1;let ot=0,pt=null;for(let qt=this.dom;qt;)if(1==qt.nodeType)!pt&&ot<this.scrollTargets.length&&this.scrollTargets[ot]==qt?ot++:pt||(pt=this.scrollTargets.slice(0,ot)),pt&&pt.push(qt),qt=qt.assignedSlot||qt.parentNode;else if(11==qt.nodeType)qt=qt.host;else break;if(ot<this.scrollTargets.length&&!pt&&(pt=this.scrollTargets.slice(0,ot)),pt){for(let rt of this.scrollTargets)rt.removeEventListener("scroll",this.onScroll);for(let st of this.scrollTargets=pt)st.addEventListener("scroll",this.onScroll)}}ignore(tt){if(!this.active)return tt();try{return this.stop(),tt()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Ps),Qs&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){!!this.active&&(this.active=!1,this.observer.disconnect(),Qs&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.observer.takeRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(ut,vt){this.delayedAndroidKey||requestAnimationFrame(()=>{let a=this.delayedAndroidKey;this.delayedAndroidKey=null;let b=this.view.state;x(this.view.contentDOM,a.key,a.keyCode)?this.processRecords():this.flush(),this.view.state==b&&this.view.update([])}),this.delayedAndroidKey&&"Enter"!=ut||(this.delayedAndroidKey={key:ut,keyCode:vt})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout(()=>{this.delayedFlush=-1,this.flush()},20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let wt=this.queue;for(let xt of this.observer.takeRecords())wt.push(xt);wt.length&&(this.queue=[]);let yt=-1,zt=-1,At=!1;for(let Bt of wt){let Ct=this.readMutation(Bt);Ct&&(Ct.typeOver&&(At=!0),-1==yt?{from:yt,to:zt}=Ct:(yt=Math.min(Ct.from,yt),zt=Math.max(Ct.to,zt)))}return{from:yt,to:zt,typeOver:At}}flush(Dt=!0){if(!(this.delayedFlush>=0)&&!this.delayedAndroidKey){Dt&&this.readSelectionRange();let{from:Et,to:Ft,typeOver:Gt}=this.processRecords(),Ht=this.selectionChanged&&k(this.dom,this.selectionRange);if(!(Et<0)||Ht){this.selectionChanged=!1;let It=this.view.state;this.onChange(Et,Ft,Gt),this.view.state==It&&this.view.update([])}}}readMutation(Jt){let Kt=this.view.docView.nearest(Jt.target);if(!Kt||Kt.ignoreMutation(Jt))return null;if(Kt.markDirty("attributes"==Jt.type),"attributes"==Jt.type&&(Kt.dirty|=4),"childList"==Jt.type){let Lt=Rs(Kt,Jt.previousSibling||Jt.target.previousSibling,-1),Mt=Rs(Kt,Jt.nextSibling||Jt.target.nextSibling,1);return{from:Lt?Kt.posAfter(Lt):Kt.posAtStart,to:Mt?Kt.posBefore(Mt):Kt.posAtEnd,typeOver:!1}}return"characterData"==Jt.type?{from:Kt.posAtStart,to:Kt.posAtEnd,typeOver:Jt.target.nodeValue==Jt.oldValue}:null}destroy(){var Nt,Ot,Pt;for(let Qt of(this.stop(),null===(Nt=this.intersection)|| void 0===Nt||Nt.disconnect(),null===(Ot=this.gapIntersection)|| void 0===Ot||Ot.disconnect(),null===(Pt=this.resize)|| void 0===Pt||Pt.disconnect(),this.scrollTargets))Qt.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}(this,(a,b,c)=>{!function(a,b,c,e){let f,g,h=a.state.selection.main;if(b> -1){let i=a.docView.domBoundsAround(b,c,0);if(!i||a.state.readOnly)return;let{from:k,to:l}=i,m=a.docView.impreciseHead||a.docView.impreciseAnchor?[]:function(a){let b=[];if(a.root.activeElement!=a.contentDOM)return b;let{anchorNode:c,anchorOffset:d,focusNode:e,focusOffset:f}=a.observer.selectionRange;return c&&(b.push(new Wh(c,d)),(e!=c||f!=d)&&b.push(new Wh(e,f))),b}(a),n=new Bh(m,a);n.readRange(i.startDOM,i.endDOM),g=(function(a,b){if(0==a.length)return null;let c=a[0].pos,e=2==a.length?a[1].pos:c;return c> -1&&e> -1?d.jT.single(c+b,e+b):null})(m,k);let o=h.from,p=null;(8===a.inputState.lastKeyCode&&a.inputState.lastKeyTime>Date.now()-100||hb.android&&n.text.length<l-k)&&(o=h.to,p="end");let q=function(a,b,c,d){let e=Math.min(a.length,b.length),f=0;for(;f<e&&a.charCodeAt(f)==b.charCodeAt(f);)f++;if(f==e&&a.length==b.length)return null;let g=a.length,h=b.length;for(;g>0&&h>0&&a.charCodeAt(g-1)==b.charCodeAt(h-1);)g--,h--;if("end"==d){let i=Math.max(0,f-Math.min(g,h));c-=g+i-f}return g<f&&a.length<b.length?(h=(f-=c<=f&&c>=g?f-c:0)+(h-g),g=f):h<f&&(g=(f-=c<=f&&c>=h?f-c:0)+(g-h),h=f),{from:f,toA:g,toB:h}}(a.state.sliceDoc(k,l),n.text,o-k,p);q&&(f={from:k+q.from,to:k+q.toA,insert:a.state.toText(n.text.slice(q.from,q.toB))})}else if(a.hasFocus||!a.state.facet(Hf)){let r=a.observer.selectionRange,{impreciseHead:s,impreciseAnchor:t}=a.docView,u=s&&s.node==r.focusNode&&s.offset==r.focusOffset||!j(a.contentDOM,r.focusNode)?a.state.selection.main.head:a.docView.posFromDOM(r.focusNode,r.focusOffset),v=t&&t.node==r.anchorNode&&t.offset==r.anchorOffset||!j(a.contentDOM,r.anchorNode)?a.state.selection.main.anchor:a.docView.posFromDOM(r.anchorNode,r.anchorOffset);(u!=h.head||v!=h.anchor)&&(g=d.jT.single(v,u))}if(f||g){if(!f&&e&&!h.empty&&g&&g.main.empty?f={from:h.from,to:h.to,insert:a.state.doc.slice(h.from,h.to)}:f&&f.from>=h.from&&f.to<=h.to&&(f.from!=h.from||f.to!=h.to)&&h.to-h.from-(f.to-f.from)<=4&&(f={from:h.from,to:h.to,insert:a.state.doc.slice(h.from,f.from).append(f.insert).append(a.state.doc.slice(f.to,h.to))}),f){let w=a.state;if(hb.ios&&a.inputState.flushIOSKey(a))return;if(hb.android&&(f.from==h.from&&f.to==h.to&&1==f.insert.length&&2==f.insert.lines&&x(a.contentDOM,"Enter",13)||f.from==h.from-1&&f.to==h.to&&0==f.insert.length&&x(a.contentDOM,"Backspace",8)||f.from==h.from&&f.to==h.to+1&&0==f.insert.length&&x(a.contentDOM,"Delete",46)))return;let y=f.insert.toString();if(a.state.facet(Df).some(b=>b(a,f.from,f.to,y)))return;a.inputState.composing>=0&&a.inputState.composing++;let z;if(f.from>=h.from&&f.to<=h.to&&f.to-f.from>=(h.to-h.from)/3&&(!g||g.main.empty&&g.main.from==f.from+f.insert.length)){let A=h.from<f.from?w.sliceDoc(h.from,f.from):"",B=h.to>f.to?w.sliceDoc(f.to,h.to):"";z=w.replaceSelection(a.state.toText(A+f.insert.sliceString(0,void 0,a.state.lineBreak)+B))}else{let C=w.changes(f);z={changes:C,selection:g&&!w.selection.main.eq(g.main)&&g.main.to<=C.newLength?w.selection.replaceRange(g.main):void 0}}let D="input.type";a.composing&&(D+=".compose",a.inputState.compositionFirstChange&&(D+=".start",a.inputState.compositionFirstChange=!1)),a.dispatch(z,{scrollIntoView:!0,userEvent:D})}else if(g&&!g.main.eq(h)){let E=!1,F="select";a.inputState.lastSelectionTime>Date.now()-50&&("select"==a.inputState.lastSelectionOrigin&&(E=!0),F=a.inputState.lastSelectionOrigin),a.dispatch({selection:g,scrollIntoView:E,userEvent:F})}}}(this,a,b,c)},a=>{this.inputState.runScrollHandlers(this,a),this.observer.intersecting&&this.measure()}),this.inputState=new class{constructor(Rt){for(let St in this.lastKeyCode=0,this.lastKeyTime=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null,Uk){let Tt=Uk[St];Rt.contentDOM.addEventListener(St,a=>{!("keydown"==St&&this.keydown(Rt,a))&&(!Tk(Rt,a)||this.ignoreDuringComposition(a)||(this.mustFlushObserver(a)&&Rt.observer.forceFlush(),this.runCustomHandlers(St,Rt,a)?a.preventDefault():Tt(Rt,a)))}),this.registeredEvents.push(St)}this.notifiedFocused=Rt.hasFocus,this.ensureHandlers(Rt),hb.safari&&Rt.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(Ut){this.lastSelectionOrigin=Ut,this.lastSelectionTime=Date.now()}ensureHandlers(Vt){let Wt=this.customHandlers=Vt.pluginField(ag);for(let Xt of Wt)for(let Yt in Xt.handlers)0>this.registeredEvents.indexOf(Yt)&&"scroll"!=Yt&&(this.registeredEvents.push(Yt),Vt.contentDOM.addEventListener(Yt,a=>{!!Tk(Vt,a)&&this.runCustomHandlers(Yt,Vt,a)&&a.preventDefault()}))}runCustomHandlers(Zt,$t,_t){for(let au of this.customHandlers){let bu=au.handlers[Zt];if(bu)try{if(bu.call(au.plugin,_t,$t))return!0}catch(cu){Gf($t.state,cu)}}return!1}runScrollHandlers(du,eu){for(let fu of this.customHandlers){let gu=fu.handlers.scroll;if(gu)try{gu.call(fu.plugin,eu,du)}catch(hu){Gf(du.state,hu)}}}keydown(iu,ju){if(this.lastKeyCode=ju.keyCode,this.lastKeyTime=Date.now(),this.screenKeyEvent(iu,ju))return!0;if(hb.android&&hb.chrome&&!ju.synthetic&&(13==ju.keyCode||8==ju.keyCode))return iu.observer.delayAndroidKey(ju.key,ju.keyCode),!0;let ku;return!!(hb.ios&&(ku=zk.find(a=>a.keyCode==ju.keyCode)))&&!(ju.ctrlKey||ju.altKey||ju.metaKey)&&!ju.synthetic&&(this.pendingIOSKey=ku,setTimeout(()=>this.flushIOSKey(iu),250),!0)}flushIOSKey(lu){let mu=this.pendingIOSKey;return!!mu&&(this.pendingIOSKey=void 0,x(lu.contentDOM,mu.key,mu.keyCode))}ignoreDuringComposition(nu){return!!/^key/.test(nu.type)&&(this.composing>0|| !!(hb.safari&&Date.now()-this.compositionEndedAt<500)&&(this.compositionEndedAt=0,!0))}screenKeyEvent(ou,pu){let qu=9==pu.keyCode&&Date.now()<this.lastEscPress+2000;return 27==pu.keyCode?this.lastEscPress=Date.now():0>Ak.indexOf(pu.keyCode)&&(this.lastEscPress=0),qu}mustFlushObserver(ru){return"keydown"==ru.type&&229!=ru.keyCode||"compositionend"==ru.type&&!hb.ios}startMouseSelection(su){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=su}update(tu){this.mouseSelection&&this.mouseSelection.update(tu),tu.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}(this),this.docView=new Zh(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,window.addEventListener("resize",()=>{-1==nw&&(nw=setTimeout(ow,50))}),this.requestMeasure(),Ts.parent&&Ts.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}dispatch(...uu){this._dispatch(1==uu.length&&uu[0]instanceof d.YW?uu[0]:this.state.update(...uu))}update(vu){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let wu=!1,xu,yu=this.state;for(let zu of vu){if(zu.startState!=yu)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");yu=zu.state}if(this.destroyed){this.viewState.state=yu;return}if(yu.facet(d.yy.phrases)!=this.state.facet(d.yy.phrases))return this.setState(yu);xu=new Rg(this,yu,vu);let Au=null;try{for(let Bu of(this.updateState=2,vu)){if(Au&&(Au=Au.map(Bu.changes)),Bu.scrollIntoView){let{main:Cu}=Bu.state.selection;Au=new Xp(Cu.empty?Cu:d.jT.cursor(Cu.head,Cu.head>Cu.anchor?-1:1))}for(let Du of Bu.effects)Du.is(Ef)?Au=new Xp(Du.value):Du.is(Ff)&&(Au=new Xp(Du.value,!0))}this.viewState.update(xu,Au),this.bidiCache=qw.update(this.bidiCache,xu.changes),xu.empty||(this.updatePlugins(xu),this.inputState.update(xu)),wu=this.docView.update(xu),this.state.facet(sg)!=this.styleModules&&this.mountStyles(),this.updateAttrs(),this.showAnnouncements(vu),this.docView.updateSelection(wu,vu.some(a=>a.isUserEvent("select.pointer")))}finally{this.updateState=0}if((wu||Au||this.viewState.mustEnforceCursorAssoc)&&this.requestMeasure(),!xu.empty)for(let Eu of this.state.facet(Cf))Eu(xu)}setState(Fu){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=Fu;return}this.updateState=2;try{for(let Gu of this.plugins)Gu.destroy(this);for(let Hu of(this.viewState=new _p(Fu),this.plugins=Fu.facet(Of).map(a=>new bg(a)),this.pluginMap.clear(),this.plugins))Hu.update(this);this.docView=new Zh(this),this.inputState.ensureHandlers(this),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}this.requestMeasure()}updatePlugins(Iu){let Ju=Iu.startState.facet(Of),Ku=Iu.state.facet(Of);if(Ju!=Ku){let Lu=[];for(let Mu of Ku){let Nu=Ju.indexOf(Mu);if(Nu<0)Lu.push(new bg(Mu));else{let Ou=this.plugins[Nu];Ou.mustUpdate=Iu,Lu.push(Ou)}}for(let Pu of this.plugins)Pu.mustUpdate!=Iu&&Pu.destroy(this);this.plugins=Lu,this.pluginMap.clear(),this.inputState.ensureHandlers(this)}else for(let Qu of this.plugins)Qu.mustUpdate=Iu;for(let Ru=0;Ru<this.plugins.length;Ru++)this.plugins[Ru].update(this)}measure(Su=!0){if(!this.destroyed){this.measureScheduled> -1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,Su&&this.observer.flush();let Tu=null;try{for(let Uu=0;;Uu++){this.updateState=1;let Vu=this.viewport,Wu=this.viewState.measure(this);if(!Wu&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(Uu>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let Xu=[];4&Wu||([this.measureRequests,Xu]=[Xu,this.measureRequests]);let Yu=Xu.map(a=>{try{return a.read(this)}catch(b){return Gf(this.state,b),pw}}),Zu=new Rg(this,this.state),$u=!1;Zu.flags|=Wu,Tu?Tu.flags|=Wu:Tu=Zu,this.updateState=2,Zu.empty||(this.updatePlugins(Zu),this.inputState.update(Zu),this.updateAttrs(),$u=this.docView.update(Zu));for(let _u=0;_u<Xu.length;_u++)if(Yu[_u]!=pw)try{let av=Xu[_u];av.write&&av.write(Yu[_u],this)}catch(bv){Gf(this.state,bv)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null),$u&&this.docView.updateSelection(!0),this.viewport.from==Vu.from&&this.viewport.to==Vu.to&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(Tu&&!Tu.empty)for(let cv of this.state.facet(Cf))cv(Tu)}}get themeClasses(){return Js+" "+(this.state.facet(Is)?Ls:Ks)+" "+this.state.facet(Hs)}updateAttrs(){let dv=Bw(this,pg,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),ev={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Hf)?"true":"false",class:"cm-content",style:`${hb.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(ev["aria-readonly"]="true"),Bw(this,qg,ev),this.observer.ignore(()=>{Rc(this.contentDOM,this.contentAttrs,ev),Rc(this.dom,this.editorAttrs,dv)}),this.editorAttrs=dv,this.contentAttrs=ev}showAnnouncements(fv){let gv=!0;for(let hv of fv)for(let iv of hv.effects)iv.is(Ss.announce)&&(gv&&(this.announceDOM.textContent=""),gv=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=iv.value)}mountStyles(){this.styleModules=this.state.facet(sg),f.V.mount(this.root,this.styleModules.concat(Os).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled> -1&&this.measure(!1)}requestMeasure(jv){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame(()=>this.measure())),jv){if(null!=jv.key){for(let kv=0;kv<this.measureRequests.length;kv++)if(this.measureRequests[kv].key===jv.key){this.measureRequests[kv]=jv;return}}this.measureRequests.push(jv)}}pluginField(lv){let mv=[];for(let nv of this.plugins)nv.update(this).takeField(lv,mv);return mv}plugin(ov){let pv=this.pluginMap.get(ov);return(void 0===pv||pv&&pv.spec!=ov)&&this.pluginMap.set(ov,pv=this.plugins.find(a=>a.spec==ov)||null),pv&&pv.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}blockAtHeight(qv,rv){let sv=mw(rv,this);return this.elementAtHeight(qv-sv).moveY(sv)}elementAtHeight(tv){return this.readMeasured(),this.viewState.elementAtHeight(tv)}visualLineAtHeight(uv,vv){let wv=mw(vv,this);return this.lineBlockAtHeight(uv-wv).moveY(wv)}lineBlockAtHeight(xv){return this.readMeasured(),this.viewState.lineBlockAtHeight(xv)}viewportLines(yv,zv){let Av=mw(zv,this);for(let Bv of this.viewportLineBlocks)yv(Bv.moveY(Av))}get viewportLineBlocks(){return this.viewState.viewportLines}visualLineAt(Cv,Dv=0){return this.lineBlockAt(Cv).moveY(Dv+this.viewState.paddingTop)}lineBlockAt(Ev){return this.viewState.lineBlockAt(Ev)}get contentHeight(){return this.viewState.contentHeight}moveByChar(Fv,Gv,Hv){return yk(this,Fv,xk(this,Fv,Gv,Hv))}moveByGroup(Iv,Jv){return yk(this,Iv,xk(this,Iv,Jv,a=>{var b,c;let e,f;return b=this,Iv.head,c=a,f=(e=b.state.charCategorizer(Iv.head))(c),a=>{let b=e(a);return f==d.D0.Space&&(f=b),f==b}}))}moveToLineBoundary(Kv,Lv,Mv=!0){return(function(a,b,c,e){let f=a.state.doc.lineAt(b.head),g=e&&a.lineWrapping?a.coordsAtPos(b.assoc<0&&b.head>f.from?b.head-1:b.head):null;if(g){let h=a.dom.getBoundingClientRect(),i=a.posAtCoords({x:c==(a.textDirection==Zg.LTR)?h.right-1:h.left+1,y:(g.top+g.bottom)/2});if(null!=i)return d.jT.cursor(i,c?-1:1)}let j=Nd.find(a.docView,b.head),k=j?c?j.posAtEnd:j.posAtStart:c?f.to:f.from;return d.jT.cursor(k,c?-1:1)})(this,Kv,Lv,Mv)}moveVertically(Nv,Ov,Pv){return yk(this,Nv,function(a,b,c,e){let f=b.head,g=c?1:-1;if(f==(c?a.state.doc.length:0))return d.jT.cursor(f);let h=b.goalColumn,i,j=a.contentDOM.getBoundingClientRect(),k=a.coordsAtPos(f),l=a.documentTop;if(k)null==h&&(h=k.left-j.left),i=g<0?k.top:k.bottom;else{let m=a.viewState.lineBlockAt(f-l);null==h&&(h=Math.min(j.right-j.left,a.defaultCharacterWidth*(f-m.from))),i=(g<0?m.top:m.bottom)+l}let n=j.left+h,o=null!=e?e:a.defaultLineHeight>>1;for(let p=0;;p+=10){let q=i+(o+p)*g,r=uk(a,{x:n,y:q},!1,g);if(q<j.top||q>j.bottom||(g<0?r<f:r>f))return d.jT.cursor(r,void 0,void 0,h)}}(this,Nv,Ov,Pv))}scrollPosIntoView(Qv){this.dispatch({effects:Ef.of(d.jT.cursor(Qv))})}domAtPos(Rv){return this.docView.domAtPos(Rv)}posAtDOM(Sv,Tv=0){return this.docView.posFromDOM(Sv,Tv)}posAtCoords(Uv,Vv=!0){return this.readMeasured(),uk(this,Uv,Vv)}coordsAtPos(Wv,Xv=1){this.readMeasured();let Yv=this.docView.coordsAt(Wv,Xv);if(!Yv||Yv.left==Yv.right)return Yv;let Zv=this.state.doc.lineAt(Wv),$v=this.bidiSpans(Zv);return r(Yv,$v[kh.find($v,Wv-Zv.from,-1,Xv)].dir==Zg.LTR==Xv>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.heightOracle.direction}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(_v){if(_v.length>lw)return yh(_v.length);let aw=this.textDirection;for(let bw of this.bidiCache)if(bw.from==_v.from&&bw.dir==aw)return bw.order;let cw=function(a,b){let c=a.length,d=b==$g?1:2,e=b==$g?2:1;if(!a||1==d&&!jh.test(a))return yh(c);for(let f=0,g=d,h=d;f<c;f++){let i=ih(a.charCodeAt(f));512==i?i=g:8==i&&4==h&&(i=16),xh[f]=4==i?2:i,7&i&&(h=i),g=i}for(let j=0,k=d,l=d;j<c;j++){let m=xh[j];if(128==m)j<c-1&&k==xh[j+1]&&24&k?m=xh[j]=k:xh[j]=256;else if(64==m){let n=j+1;for(;n<c&&64==xh[n];)n++;let o=j&&8==k||n<c&&8==xh[n]?1==l?1:8:256;for(let p=j;p<n;p++)xh[p]=o;j=n-1}else 8==m&&1==l&&(xh[j]=1);k=m,7&m&&(l=m)}for(let q=0,r=0,s=0,t,u,v;q<c;q++)if(u=dh[t=a.charCodeAt(q)])if(u<0){for(let w=r-3;w>=0;w-=3)if(eh[w+1]== -u){let x=eh[w+2],y=2&x?d:4&x?1&x?e:d:0;y&&(xh[q]=xh[eh[w]]=y),r=w;break}}else if(189==eh.length)break;else eh[r++]=q,eh[r++]=t,eh[r++]=s;else if(2==(v=xh[q])||1==v){let z=v==d;s=z?0:1;for(let A=r-3;A>=0;A-=3){let B=eh[A+2];if(2&B)break;if(z)eh[A+2]|=2;else{if(4&B)break;eh[A+2]|=4}}}for(let C=0;C<c;C++)if(256==xh[C]){let D=C+1;for(;D<c&&256==xh[D];)D++;let E=(C?xh[C-1]:d)==1,F=E==((D<c?xh[D]:d)==1)?E?1:2:d;for(let G=C;G<D;G++)xh[G]=F;C=D-1}let H=[];if(1==d)for(let I=0;I<c;){let J=I,K=1!=xh[I++];for(;I<c&&K==(1!=xh[I]);)I++;if(K)for(let L=I;L>J;){let M=L,N=2!=xh[--L];for(;L>J&&N==(2!=xh[L-1]);)L--;H.push(new kh(L,M,N?2:1))}else H.push(new kh(J,I,0))}else for(let O=0;O<c;){let P=O,Q=2==xh[O++];for(;O<c&&Q==(2==xh[O]);)O++;H.push(new kh(P,O,Q?1:2))}return H}(_v.text,this.textDirection);return this.bidiCache.push(new qw(_v.from,_v.to,aw,cw)),cw}get hasFocus(){var dw;return(document.hasFocus()||hb.safari&&(null===(dw=this.inputState)|| void 0===dw?void 0:dw.lastContextMenu)>Date.now()-30e3)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{u(this.contentDOM),this.docView.updateSelection()})}destroy(){for(let ew of this.plugins)ew.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled> -1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static domEventHandlers(fw){return Pf.define(()=>({}),{eventHandlers:fw})}static theme(gw,hw){let iw=f.V.newName(),jw=[Hs.of(iw),sg.of(Ns(`.${iw}`,gw))];return hw&&hw.dark&&jw.push(Is.of(!0)),jw}static baseTheme(kw){return d.Wl.lowest(sg.of(Ns("."+Js,kw,Ms)))}}Ss.scrollTo=Ef,Ss.centerOn=Ff,Ss.styleModule=sg,Ss.inputHandler=Df,Ss.exceptionSink=Bf,Ss.updateListener=Cf,Ss.editable=Hf,Ss.mouseSelectionStyle=Af,Ss.dragMovesSelection=zf,Ss.clickAddsSelectionRange=yf,Ss.decorations=rg,Ss.contentAttributes=qg,Ss.editorAttributes=pg,Ss.lineWrapping=Ss.contentAttributes.of({"class":"cm-lineWrapping"}),Ss.announce=d.Py.define();const lw=4096;function mw(a,b){return(null==a?b.contentDOM.getBoundingClientRect().top:a)+b.viewState.paddingTop}let nw=-1;function ow(){nw=-1;let a=document.querySelectorAll(".cm-content");for(let b=0;b<a.length;b++){let c=H.get(a[b]);c&&c.editorView.requestMeasure()}}const pw={};class qw{constructor(rw,sw,tw,uw){this.from=rw,this.to=sw,this.dir=tw,this.order=uw}static update(vw,ww){if(ww.empty)return vw;let xw=[],yw=vw.length?vw[vw.length-1].dir:Zg.LTR;for(let zw=Math.max(0,vw.length-10);zw<vw.length;zw++){let Aw=vw[zw];Aw.dir!=yw||ww.touchesRange(Aw.from,Aw.to)||xw.push(new qw(ww.mapPos(Aw.from,1),ww.mapPos(Aw.to,-1),Aw.dir,Aw.order))}return xw}}function Bw(a,b,c){for(let d=a.state.facet(b),e=d.length-1;e>=0;e--){let f=d[e],g="function"==typeof f?f(a):f;g&&Pc(g,c)}return c}const Cw=hb.mac?"mac":hb.windows?"win":hb.linux?"linux":"key";function Dw(a,b,c){return b.altKey&&(a="Alt-"+a),b.ctrlKey&&(a="Ctrl-"+a),b.metaKey&&(a="Meta-"+a),!1!==c&&b.shiftKey&&(a="Shift-"+a),a}const Ew=Ss.domEventHandlers({keydown(a,b){return Lw(Hw(b.state),a,b,"editor")}}),Fw=d.r$.define({enables:Ew}),Gw=new WeakMap();function Hw(a){let b=a.facet(Fw),c=Gw.get(b);return c||Gw.set(b,c=Kw(b.reduce((a,b)=>a.concat(b),[]))),c}function Iw(a,b,c){return Lw(Hw(a.state),b,a,c)}let Jw=null;function Kw(a,b=Cw){let c=Object.create(null),d=Object.create(null),e=(a,b)=>{let c=d[a];if(null==c)d[a]=b;else if(c!=b)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},f=(a,d,f,g)=>{let h=c[a]||(c[a]=Object.create(null)),i=d.split(/ (?!$)/).map(a=>(function(a,b){const c=a.split(/-(?!$)/);let d=c[c.length-1];"Space"==d&&(d=" ");let e,f,g,h;for(let i=0;i<c.length-1;++i){const j=c[i];if(/^(cmd|meta|m)$/i.test(j))h=!0;else if(/^a(lt)?$/i.test(j))e=!0;else if(/^(c|ctrl|control)$/i.test(j))f=!0;else if(/^s(hift)?$/i.test(j))g=!0;else if(/^mod$/i.test(j))"mac"==b?h=!0:f=!0;else throw new Error("Unrecognized modifier name: "+j)}return e&&(d="Alt-"+d),f&&(d="Ctrl-"+d),h&&(d="Meta-"+d),g&&(d="Shift-"+d),d})(a,b));for(let j=1;j<i.length;j++){let k=i.slice(0,j).join(" ");e(k,!0),h[k]||(h[k]={preventDefault:!0,commands:[b=>{let c=Jw={view:b,prefix:k,scope:a};return setTimeout(()=>{Jw==c&&(Jw=null)},4000),!0}]})}let l=i.join(" ");e(l,!1);let m=h[l]||(h[l]={preventDefault:!1,commands:[]});m.commands.push(f),g&&(m.preventDefault=!0)};for(let g of a){let h=g[b]||g.key;if(h)for(let i of g.scope?g.scope.split(" "):["editor"])f(i,h,g.run,g.preventDefault),g.shift&&f(i,"Shift-"+h,g.shift,g.preventDefault)}return c}function Lw(a,b,c,d){let e=(0,h.YG)(b),f=1==e.length&&" "!=e,g="",i=!1;Jw&&Jw.view==c&&Jw.scope==d&&(g=Jw.prefix+" ",(i=0>Ak.indexOf(b.keyCode))&&(Jw=null));let j=a=>{if(a){for(let b of a.commands)if(b(c))return!0;a.preventDefault&&(i=!0)}return!1},k=a[d],l;if(k){if(j(k[g+Dw(e,b,!f)]))return!0;if(f&&(b.shiftKey||b.altKey||b.metaKey)&&(l=h.ue[b.keyCode])&&l!=e){if(j(k[g+Dw(l,b,!0)]))return!0}else if(f&&b.shiftKey&&j(k[g+Dw(e,b,!0)]))return!0}return i}const Mw=!hb.ios,Nw=d.r$.define({combine(a){return(0,d.BO)(a,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(a,b)=>Math.min(a,b),drawRangeCursor:(a,b)=>a||b})}});function Ow(a={}){return[Nw.of(a),Yw,nx]}class Pw{constructor(Qw,Rw,Sw,Tw,Uw){this.left=Qw,this.top=Rw,this.width=Sw,this.height=Tw,this.className=Uw}draw(){let Vw=document.createElement("div");return Vw.className=this.className,this.adjust(Vw),Vw}adjust(Ww){Ww.style.left=this.left+"px",Ww.style.top=this.top+"px",this.width>=0&&(Ww.style.width=this.width+"px"),Ww.style.height=this.height+"px"}eq(Xw){return this.left==Xw.left&&this.top==Xw.top&&this.width==Xw.width&&this.height==Xw.height&&this.className==Xw.className}}const Yw=Pf.fromClass(class{constructor(Zw){this.view=Zw,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=Zw.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=Zw.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),Zw.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(Nw).cursorBlinkRate+"ms"}update($w){let _w=$w.startState.facet(Nw)!=$w.state.facet(Nw);(_w||$w.selectionSet||$w.geometryChanged||$w.viewportChanged)&&this.view.requestMeasure(this.measureReq),$w.transactions.some(a=>a.scrollIntoView)&&(this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink"),_w&&this.setBlinkRate()}readPos(){let{state:ax}=this.view,bx=ax.facet(Nw),cx=ax.selection.ranges.map(a=>a.empty?[]:rx(this.view,a)).reduce((a,b)=>a.concat(b)),dx=[];for(let ex of ax.selection.ranges){let fx=ex==ax.selection.main;if(ex.empty?!fx||Mw:bx.drawRangeCursor){let gx=sx(this.view,ex,fx);gx&&dx.push(gx)}}return{rangePieces:cx,cursors:dx}}drawSel({rangePieces:hx,cursors:ix}){if(hx.length!=this.rangePieces.length||hx.some((a,b)=>!a.eq(this.rangePieces[b]))){for(let jx of(this.selectionLayer.textContent="",hx))this.selectionLayer.appendChild(jx.draw());this.rangePieces=hx}if(ix.length!=this.cursors.length||ix.some((a,b)=>!a.eq(this.cursors[b]))){let kx=this.cursorLayer.children;if(kx.length!==ix.length)for(const lx of(this.cursorLayer.textContent="",ix))this.cursorLayer.appendChild(lx.draw());else ix.forEach((a,b)=>a.adjust(kx[b]));this.cursors=ix}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),mx={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Mw&&(mx[".cm-line"].caretColor="transparent !important");const nx=d.Wl.highest(Ss.theme(mx));function ox(a){let b=a.scrollDOM.getBoundingClientRect();return{left:(a.textDirection==Zg.LTR?b.left:b.right-a.scrollDOM.clientWidth)-a.scrollDOM.scrollLeft,top:b.top-a.scrollDOM.scrollTop}}function px(a,b,c){let e=d.jT.cursor(b);return{from:Math.max(c.from,a.moveToLineBoundary(e,!1,!0).from),to:Math.min(c.to,a.moveToLineBoundary(e,!0,!0).from),type:Zc.Text}}function qx(a,b){let c=a.lineBlockAt(b);if(Array.isArray(c.type)){for(let d of c.type)if(d.to>b||d.to==b&&(d.to==c.to||d.type==Zc.Text))return d}return c}function rx(a,b){if(b.to<=a.viewport.from||b.from>=a.viewport.to)return[];let c=Math.max(b.from,a.viewport.from),d=Math.min(b.to,a.viewport.to),e=a.textDirection==Zg.LTR,f=a.contentDOM,g=f.getBoundingClientRect(),h=ox(a),i=window.getComputedStyle(f.firstChild),j=g.left+parseInt(i.paddingLeft),k=g.right-parseInt(i.paddingRight),l=qx(a,c),m=qx(a,d),n=l.type==Zc.Text?l:null,o=m.type==Zc.Text?m:null;if(a.lineWrapping&&(n&&(n=px(a,c,n)),o&&(o=px(a,d,o))),n&&o&&n.from==o.from)return t(u(b.from,b.to,n));{let p=n?u(b.from,null,n):v(l,!1),q=o?u(null,b.to,o):v(m,!0),r=[];return(n||l).to<(o||m).from-1?r.push(s(j,p.bottom,k,q.top)):p.bottom<q.top&&a.elementAtHeight((p.bottom+q.top)/2).type==Zc.Text&&(p.bottom=q.top=(p.bottom+q.top)/2),t(p).concat(r).concat(t(q))}function s(a,b,c,d){return new Pw(a-h.left,b-h.top,c-a,d-b,"cm-selectionBackground")}function t({top:a,bottom:b,horizontal:c}){let d=[];for(let e=0;e<c.length;e+=2)d.push(s(c[e],a,c[e+1],b));return d}function u(b,c,d){let f=10e8,g=-10e8,h=[];function i(b,c,i,l,m){let n=a.coordsAtPos(b,b==d.to?-2:2),o=a.coordsAtPos(i,i==d.from?2:-2);f=Math.min(n.top,o.top,f),g=Math.max(n.bottom,o.bottom,g),m==Zg.LTR?h.push(e&&c?j:n.left,e&&l?k:o.right):h.push(!e&&l?j:o.left,!e&&c?k:n.right)}let l=null!=b?b:d.from,m=null!=c?c:d.to;for(let n of a.visibleRanges)if(n.to>l&&n.from<m)for(let o=Math.max(n.from,l),p=Math.min(n.to,m);;){let q=a.state.doc.lineAt(o);for(let r of a.bidiSpans(q)){let s=r.from+q.from,t=r.to+q.from;if(s>=p)break;t>o&&i(Math.max(s,o),null==b&&s<=l,Math.min(t,p),null==c&&t>=m,r.dir)}if((o=q.to+1)>=p)break}return 0==h.length&&i(l,null==b,m,null==c,a.textDirection),{top:f,bottom:g,horizontal:h}}function v(a,b){let c=g.top+(b?a.top:a.bottom);return{top:c,bottom:c,horizontal:[]}}}function sx(a,b,c){let d=a.coordsAtPos(b.head,b.assoc||1);if(!d)return null;let e=ox(a);return new Pw(d.left-e.left,d.top-e.top,-1,d.bottom-d.top,c?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const tx=d.Py.define({map(a,b){return null==a?null:b.mapPos(a)}}),ux=d.QQ.define({create(){return null},update(a,b){return null!=a&&(a=b.changes.mapPos(a)),b.effects.reduce((a,b)=>b.is(tx)?b.value:a,a)}}),vx=Pf.fromClass(class{constructor(wx){this.view=wx,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(xx){var yx;let zx=xx.state.field(ux);null==zx?null!=this.cursor&&(null===(yx=this.cursor)|| void 0===yx||yx.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(xx.startState.field(ux)!=zx||xx.docChanged||xx.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let Ax=this.view.state.field(ux),Bx=null!=Ax&&this.view.coordsAtPos(Ax);if(!Bx)return null;let Cx=this.view.scrollDOM.getBoundingClientRect();return{left:Bx.left-Cx.left,top:Bx.top-Cx.top,height:Bx.bottom-Bx.top}}drawCursor(Dx){this.cursor&&(Dx?(this.cursor.style.left=Dx.left+"px",this.cursor.style.top=Dx.top+"px",this.cursor.style.height=Dx.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(Ex){this.view.state.field(ux)!=Ex&&this.view.dispatch({effects:tx.of(Ex)})}},{eventHandlers:{dragover(a){this.setDropPos(this.view.posAtCoords({x:a.clientX,y:a.clientY}))},dragleave(a){a.target!=this.view.contentDOM&&this.view.contentDOM.contains(a.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Fx(){return[ux,vx]}function Gx(a,b,c,d,e){b.lastIndex=0;for(let f=a.iterRange(c,d),g=c,h;!f.next().done;g+=f.value.length)if(!f.lineBreak)for(;h=b.exec(f.value);)e(g+h.index,g+h.index+h[0].length,h)}class Hx{constructor(Ix){let{regexp:Jx,decoration:Kx,boundary:Lx,maxLength:Mx=1000}=Ix;if(!Jx.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=Jx,this.getDeco="function"==typeof Kx?Kx:()=>Kx,this.boundary=Lx,this.maxLength=Mx}createDeco(Nx){let Ox=new g.f_();for(let{from:Px,to:Qx}of(function(a,b){let c=a.visibleRanges;if(1==c.length&&c[0].from==a.viewport.from&&c[0].to==a.viewport.to)return c;let d=[];for(let{from:e,to:f}of c)e=Math.max(a.state.doc.lineAt(e).from,e-b),f=Math.min(a.state.doc.lineAt(f).to,f+b),d.length&&d[d.length-1].to>=e?d[d.length-1].to=f:d.push({from:e,to:f});return d})(Nx,this.maxLength))Gx(Nx.state.doc,this.regexp,Px,Qx,(a,b,c)=>Ox.add(a,b,this.getDeco(c,Nx,a)));return Ox.finish()}updateDeco(Rx,Sx){let Tx=10e8,Ux=-1;return(Rx.docChanged&&Rx.changes.iterChanges((a,b,c,d)=>{d>Rx.view.viewport.from&&c<Rx.view.viewport.to&&(Tx=Math.min(c,Tx),Ux=Math.max(d,Ux))}),Rx.viewportChanged||Ux-Tx>1000)?this.createDeco(Rx.view):Ux> -1?this.updateRange(Rx.view,Sx.map(Rx.changes),Tx,Ux):Sx}updateRange(Vx,Wx,Xx,Yx){for(let Zx of Vx.visibleRanges){let $x=Math.max(Zx.from,Xx),_x=Math.min(Zx.to,Yx);if(_x>$x){let ay=Vx.state.doc.lineAt($x),by=ay.to<_x?Vx.state.doc.lineAt(_x):ay,cy=Math.max(Zx.from,ay.from),dy=Math.min(Zx.to,by.to);if(this.boundary){for(;$x>ay.from;$x--)if(this.boundary.test(ay.text[$x-1-ay.from])){cy=$x;break}for(;_x<by.to;_x++)if(this.boundary.test(by.text[_x-by.from])){dy=_x;break}}let ey=[],fy;if(ay==by)for(this.regexp.lastIndex=cy-ay.from;(fy=this.regexp.exec(ay.text))&&fy.index<dy-ay.from;){let gy=fy.index+ay.from;ey.push(this.getDeco(fy,Vx,gy).range(gy,gy+fy[0].length))}else Gx(Vx.state.doc,this.regexp,cy,dy,(a,b,c)=>ey.push(this.getDeco(c,Vx,a).range(a,b)));Wx=Wx.update({filterFrom:cy,filterTo:dy,filter:(a,b)=>a<cy||b>dy,add:ey})}}return Wx}}const hy=null!=/x/.unicode?"gu":"g",iy=new RegExp("[\x00-\b\n-\x1f\x7f-\x9f\xad؜​‎‏\u2028\u2029‭‮﻿￹-￼]",hy),jy={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let ky=null;const ly=d.r$.define({combine(a){let b=(0,d.BO)(a,{render:null,specialChars:iy,addSpecialChars:null});return(b.replaceTabs=!function(){var a;if(null==ky&&"undefined"!=typeof document&&document.body){let b=document.body.style;ky=(null!==(a=b.tabSize)&& void 0!==a?a:b.MozTabSize)!=null}return ky||!1}())&&(b.specialChars=new RegExp("\t|"+b.specialChars.source,hy)),b.addSpecialChars&&(b.specialChars=new RegExp(b.specialChars.source+"|"+b.addSpecialChars.source,hy)),b}});function my(a={}){return[ly.of(a),oy()]}let ny=null;function oy(){return ny||(ny=Pf.fromClass(class{constructor(a){this.view=a,this.decorations=$c.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(a.state.facet(ly)),this.decorations=this.decorator.createDeco(a)}makeDecorator(b){return new Hx({regexp:b.specialChars,decoration:(a,c,d)=>{let{doc:f}=c.state,g=(0,e.gm)(a[0],0);if(9==g){let h=f.lineAt(d),i=c.state.tabSize,j=(0,e.IS)(h.text,i,d-h.from);return $c.replace({widget:new zy((i-j%i)*this.view.defaultCharacterWidth)})}return this.decorationCache[g]||(this.decorationCache[g]=$c.replace({widget:new py(b,g)}))},boundary:b.replaceTabs?void 0:/[^]/})}update(c){let d=c.state.facet(ly);c.startState.facet(ly)!=d?(this.decorator=this.makeDecorator(d),this.decorations=this.decorator.createDeco(c.view)):this.decorations=this.decorator.updateDeco(c,this.decorations)}},{decorations:a=>a.decorations}))}class py extends Sc{constructor(qy,ry){super(),this.options=qy,this.code=ry}eq(sy){return sy.code==this.code}toDOM(ty){var uy;let vy=(uy=this.code)>=32?"•":10==uy?"␤":String.fromCharCode(9216+uy),wy=ty.state.phrase("Control character")+" "+(jy[this.code]||"0x"+this.code.toString(16)),xy=this.options.render&&this.options.render(this.code,wy,vy);if(xy)return xy;let yy=document.createElement("span");return yy.textContent=vy,yy.title=wy,yy.setAttribute("aria-label",wy),yy.className="cm-specialChar",yy}ignoreEvent(){return!1}}class zy extends Sc{constructor(Ay){super(),this.width=Ay}eq(By){return By.width==this.width}toDOM(){let Cy=document.createElement("span");return Cy.textContent="\t",Cy.className="cm-tab",Cy.style.width=this.width+"px",Cy}ignoreEvent(){return!1}}function Dy(){return Fy}const Ey=$c.line({class:"cm-activeLine"}),Fy=Pf.fromClass(class{constructor(Gy){this.decorations=this.getDeco(Gy)}update(Hy){(Hy.docChanged||Hy.selectionSet)&&(this.decorations=this.getDeco(Hy.view))}getDeco(Iy){let Jy=-1,Ky=[];for(let Ly of Iy.state.selection.ranges){if(!Ly.empty)return $c.none;let My=Iy.lineBlockAt(Ly.head);My.from>Jy&&(Ky.push(Ey.range(My.from)),Jy=My.from)}return $c.set(Ky)}},{decorations:a=>a.decorations});class Ny extends Sc{constructor(Oy){super(),this.content=Oy}toDOM(){let Py=document.createElement("span");return Py.className="cm-placeholder",Py.style.pointerEvents="none",Py.appendChild("string"==typeof this.content?document.createTextNode(this.content):this.content),"string"==typeof this.content?Py.setAttribute("aria-label","placeholder "+this.content):Py.setAttribute("aria-hidden","true"),Py}ignoreEvent(){return!1}}function Qy(a){return Pf.fromClass(class{constructor(b){this.view=b,this.placeholder=$c.set([$c.widget({widget:new Ny(a),side:1}).range(0)])}get decorations(){return this.view.state.doc.length?$c.none:this.placeholder}},{decorations:a=>a.decorations})}}}])